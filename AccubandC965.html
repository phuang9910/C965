<!doctype html>
<html lang="en">
<head>

    <title>Accuband C965</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Latest compiled  Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <style>
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted black;
        }

        .tooltip-inner {
            white-space: pre-wrap;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }

            .tooltip .tooltiptext::after {
                content: "";
                position: absolute;
                top: 100%;
                left: 50%;
                margin-left: -5px;
                border-width: 5px;
                border-style: solid;
                border-color: #555 transparent transparent transparent;
            }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }


        .formDivA {
            padding: 10px;
            border: 2px;
            border-color: green;
            border-style: solid;
            border-top-style: solid;
            border-right-style: solid;
            border-bottom-style: solid;
            border-left-style: solid;
        }

        .formDivB {
            padding: 10px;
            border: 2px;
            border-color: cadetblue;
            border-style: solid;
            border-top-style: solid;
            border-right-style: solid;
            border-bottom-style: solid;
            border-left-style: solid;
        }

        .formDivC {
            padding: 10px;
            border: 2px;
            border-color: lightgrey;
            border-style: solid;
            border-top-style: solid;
            border-right-style: solid;
            border-bottom-style: solid;
            border-left-style: solid;
        }

        input:invalid {
            border: 2px dashed red;
        }

            input:invalid:required {
                border: 2px dashed green;
            }

        input:valid {
            border: 1px solid black;
        }

        /* toggle switch settings**/
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

            .switch input {
                opacity: 0;
                width: 0;
                height: 0;
            }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

            .slider:before {
                position: absolute;
                content: "";
                height: 26px;
                width: 26px;
                left: 4px;
                bottom: 4px;
                background-color: white;
                -webkit-transition: .4s;
                transition: .4s;
            }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

            .slider.round:before {
                border-radius: 50%;
            }
        /* End of toggle switch settings**/

        .card {
            /* Add shadows to create the "card" effect */
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
            transition: 0.3s;
        }

            /* On mouse-over, add a deeper shadow */
            .card:hover {
                box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
            }

        .card-header {
            padding: 0.1rem;
        }
        /* Add some padding inside the card container */
        .container {
            padding: 2px 2px;
        }

        label, thead, tbody {
            font-size: 12px;
        }

        p {
            font-size: 16px;
        }
    </style>

    <script>

        const aMENU = [
            ['SCOPE OF SUPPLY','ScopeOfSupplyHeader', 'ScopeOfSupplyBody'],
            ['MILL DATA','RollDataHeader', 'RollDataBody'],
            ['SCANNER HEAD', 'ScannerHeader', 'ScannerHeadBody'],
            ['ACCUBAND FLOOR MOUNTED CABINET', 'AccubandFMCHeader','AccubandFMCBody'],
            ['CALIBRATOR AND CALIBRATOR CARRIER','CalibratorHeader', 'CalibratorBody'],
            ["OPERATOR'S STATION", 'OperatorHeader', 'OperatorBody'],
            ['LOW PROFILE LED BACKLIGHT', 'BackLightHeader','BackLightBody'],
            ['ACCUSPEED ASDH', 'AccuspeedHeader','AccuspeedBody'],
            ['ACCUSCAN HMD2048', 'HMD2048Header', 'HMD2048Body'],
            ['ACCUCROP', 'AccucropHeader', 'AccucropBody'],
            ['ADDITIONAL FEATURES', 'ItemGHeader','ItemGBody'],
            ['SOFTWARE FEATURES', 'SoftwareHeader', 'SoftwareBody'],
            ['FIELD SERVICE & COMMISSIONING', 'FieldServiceHeader', 'FieldServiceBody']
        ];

        const Applications = [
            //value, checked/disabled,title;
            ['WIDTHGAGE', 'checked', 'ACCUBAND C965A/B Witdh Gage (IR/BL)'],
            ['IMAGEGAGE', '', "ACCUBAND C965C Imaging System (RX/CSE)"],
            ['OPENLOOP', '', 'ACCUBAND Open Loop with Tracking(RX/CSE)'],
            ['CLOSEDLOOP', '', 'ACCUBAND/ACCUCROP Closed Loop System (RX/CSE)'],
            ['ASDH', 'disabled', 'Accuspeed ASDH'],
            ['HMD2048', 'disabled', 'Accuscan HMD2048']
        ];
        const Selections = [
            // htmlID, divID, title, [selectID1], [selectID2,selectID3],[textID,placeholder],[unit]
            ['configuratioID', 'RXCSEConfiguration', 'RX/CSE Location', 'gageLOcation'],
            ['configuratioID', 'ModeConfiguration', 'Mode of Operation','selectModeOfOperation'],
            ['millDataResultID', '', 'Optics Kits:', 'selectOpticsKit'],
            ['scannerHeaderID', '', 'Air Nozzle:', 'selectAirNozzle'],
            ['scannerHeaderID', '', 'Scanner Support:', 'selectScannerSupport'],
            //below one selection with one text 
            ['ItemBFMC2100ID', '', 'Accuband Cabinet Option:', 'ItemBFMCSupplyOption', '', '', 'AccubandWAGOWOID', 'WO Code'],
            ['selectItemB1Option', '', 'FMC Option:', 'ItemBVoltage', 'ItemBDoorType', 'ItemBVentilation'],
            //below two selection with one [text,placeholder] & [unit]
            ['selectItemB2Option', '', 'Discrete IO:', 'AB6WAGOInput', 'AB6WAGOOutput'],
            
            // below with three selections
            ['selectItemP1Option', '', 'FMC Option:', 'ItemPVoltage', 'ItemPDoorType', 'ItemPVentilation'],

            ['AccucropItemG', '', 'Absolute Encoder:', 'selectABSEncoder'],
            ['AccucropItemG', '', 'Incremental Encoder:', 'selectINCEncoder']
        ];
        const oCheckList = {
            //checkID, htmlID, P/N,title, STK,Crate
            AccubandFMCPC: {
                ID: ['ItemBFMCIncluded', 'AccubandFMCPC', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['', '', '', 'Rack Mounted PC in FMC Cabinet', '', '']
            },

            AccucropFMCPC: {
                ID: ['ItemPFMCIncluded', 'AccucropFMCPC', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['', '', '', 'Rack Mounted PC in FMC Cabinet', '', '']
            },
            CalibratorChecked: {
                ID: ['selectCalibrator', 'CalibratorChecked', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['', '', '', 'Calibrator & Calibrator Carrier are included', '', '']
            },

            ASDHLever1: {
                ID: ['formASDH1', 'ASDHLever1', '', true], //checkID, htmlID,default value sequence
                Value: ['', '', '', 'Accuspeed Quadrature Level Convertor', '', '']
            },

            ASDHLever2: {
                ID: ['formASDH2', 'ASDHLever2', '', true], //checkID, htmlID,default value sequence
                Value: ['', '', '', 'Accuspeed Quadrature Level Convertor', '', '']
            }



        };

        const oItemGCheckList = {
            //checkID, htmlID, P/N,title, STK,Crate
            AB6ServiceKit: {
                ID: ['AccubandItemG', 'AB6ServiceKit', 'checked',true], //checkID, htmlID,default value sequence
                Value: ['G1', '1', 'PL054727', 'Accuband Service Kit', 'STK', 'A2']
            },
            AB6ValvesNFilters: {
                ID: ['AccubandItemG', 'AB6ValvesNFilters', '', true], //checkID, htmlID,default value
                Value:['G2', '1', 'PL058214', 'Accuband Scanner Valves And Filters', 'MFG', 'A2']
            },
            KVMExtender: {
                ID: ['AccubandItemG', 'KVMExtender', '', true], //checkID, htmlID,default value
                Value: ['G3', '1', '*09141', 'USB KVM Extender Kit', 'PUR', 'A2']
            },
            HMDICable: {
                ID: ['AccubandItemG', 'HMDICable', '', true], //checkID, htmlID,default value
                Value: ['G4', '1', '*09142', 'HDMI cable: 6ft', 'PUR', 'A2']
            },  
            RCA: {
                ID: ['AccucropItemG', 'RCA', '',false], //checkID, htmlID,default value
                Value: ['G3', '1', 'PL050154', 'Remote Cropshear Adaptor', 'STK', 'A2']
            },  
            CropPanel: {
                ID: ['AccucropItemG', 'CropPanel', '',false], //checkID, htmlID,default value
                Value: ['G4', '1', 'PL056886', 'Crop Control Panel', 'MFG', 'A2']
            }
       };
        const oItemSCheckList = {
            //checkID, htmlID, P/N,title, STK,Crate

            TS511Checked: {
                ID: ['AccucropSoftware', 'TS511Checked', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['S3', '1', 'TS-511', 'Drive Modification', 'PUR', '']
            },
            IBAkit: {
                ID: ['commonSoftware', 'IBAKit', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['S3', '1', 'PL055226', 'Accuband IBA PDA Kit', 'PUR', 'A2']
            },
            IBAPDA: {
                ID: ['commonSoftware', 'IBAPDA', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['S3', '1', 'TBA', 'KELK IBA ModBus TCP PDA client', 'ENG', '']
            },
            TS414Server: {
                ID: ['commonSoftware', 'TS414Server', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['S3', '1', '*08518', 'Empress Runtime Server', 'PUR', 'A2']
            },
            TS414Cilent: {
                ID: ['commonSoftware', 'TS414Serverchecked', 'checked', true], //checkID, htmlID,default value sequence
                Value: ['S3', '1', '*08519', 'Empress Runtime Client', 'PUR', 'A2']
            }

        };

        var ItemA = [[]];
        const oC965 = {

            ItemCode: ['A', '1', 'C965-A-50-2-F-B', 'ACCUBAND SCANNER HEAD', 'MFG', ''],
            ScannerHead: ['A1', '1', 'PL059063-2', 'SACNNER ASSEMBLY', 'PRD', 'A1'],
            Cameras: ['A2', '2', 'PL059062-2', 'CAMERA ASSEMBLY', 'REF', 'A2'],
            OpticsKit: {
                FORTY: ['40', '2', 'PL056193', 'Optics Kit 40mm Lens', 'PRD', ''],
                FIFTY: ['50', '2', 'PL059194', 'Optics Kit 50mm Lens', 'PRD', ''],
                SIXTY: ['60', '2', 'PL059195', 'Optics Kit 60mm Lens', 'PRD', '']
            },
            Mode: {
                IR: ['A', '', 'IR', 'Infrared (IR)', '', ''],
                BL: ['B', '', 'BL', 'Backlight (BL)', '', ''],
                FL: ['', '', '', 'Frontlight (FL)', '', '']
            },

            Support: {
                FIXED: ['F', '1', 'PL050461-2', 'SCANNER SUPPORT ASSEMBLY: FIXED', 'PRD', 'A3'],
                WHEELED: ['R', '1', 'PL050461-4', 'SCANNER SUPPORT ASSEMBLY: WHEELED', 'PRD', 'A3'],
                HANGING: ['', '1', '', 'SCANNER SUPPORT ASSEMBLY: HANGING', 'PRD', 'A3']
            },
            Shim: ['A5', '1', 'PL053516', 'Shim & Hardware Kit', 'REF', 'A3'],
            PowerSupply: ['A6', '1', 'PL050753', 'Accuband POWER SUPPLY ASSEMBLY', 'PRD', 'A2'],
            CableHose: ['A7', '1', 'PL056813-15M', 'Accuband CABLE/HOSE ASSY: 15m', 'PRD', 'A2'],
            Nozzle: {
                SHORT: ['1', '1', 'PL017436', 'NOZZLE ASSY (47") ', 'PRD', 'A4'],
                LONG: ['2', '1', 'PL018187', 'NOZZLE ASSY (60") ', 'PRD', 'A4'],
                EXTRALONG: ['3', '1', 'PL051476', 'NOZZLE ASSY (65")', 'PRD', 'A4'],
                BLOWER: ['', '1', 'PL059320', 'NOZZLE FOR INLET BLOWER (69")', 'PRD', 'A4']
            },
            MediaConvertor: ['A9', '1', 'PL059131', 'Accuband P/S SC Multi Mode MEDIA CONVERTER KIT (To Be Installed in Item A6)', 'MFG', 'A2']
        };

        const oSelectionChoices = {
            AB6OpticsKit: {
                ID: ['selectOpticsKit', 'Choose Optics Kits'],
                Options: oC965.OpticsKit
            },
            AB6Mode: {
                ID: ['selectModeOfOperation', 'Choose ...'],
                Options:oC965.Mode
            },
            AB6Support: {
                ID: ['selectScannerSupport', 'Select Scanner Support'],
                Options:oC965.Support
            },
            AB6Nozzle: {
                ID: ['selectAirNozzle', 'Select Air Nozzle Type'],
                Options:oC965.Nozzle
            }
        };
    </script>
</head>

<body>

    <div>
        <div class="row">
            <div class="col-2 text-center">
            </div>
            <div class="col-2 text-center">
                <img src="https://kelk.com/sites/default/files/screenshot.png" alt="Home" class="mr-2">
            </div>
        </div>

        <div class="row">

            <div class="col-10 text-right">
                <h2 style="color: blue;" id="PageTitle">ACCUBAND C965A WIDTH GAGE</h2>
            </div>
        </div>
    </div>

    <hr />

    <div class="accordion" id="accordionAccuband">

        <!-- Scope of Supply ---->
        <div class="card ">
            <div class="card-header" id="ScopeOfSupplyHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#ScopeOfSupplyBody" aria-expanded="true" aria-controls="ScopeOfSupplyBody">
                        SCOPE OF SUPPLY
                    </button>
                </h5>
            </div>
            <div class="collapse show" id="ScopeOfSupplyBody" aria-labelledby="ScopeOfSupplyHeader" data-parent="#accordionAccuband">
                <div class="card card-body">
                    <form name="ApplicationForm" class="was-validated">
                        <div class="row">
                            <div class="col-sm-6 text-left">
                                <div class="card-title">Choose Application</div>
                                <div class="formDivA" id="ApplicationID">
                                    <!-- some code here by JS-->
                                </div>
                            </div>
                            <div class="col-sm-6 text-left">

                                <div class="card-title">Configuration:</div>
                                <div class="formDivC" id="configuratioID">
                                    <!-- some code here by JS-->
                                </div>
                            </div>
                       </div>
                        <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>

                    </form>

                    <p class="card-text">
                        <a href="90414-F Accuband 965 AB.pdf" target="_blank">Accuband C965AB User's Manual</a>
                    </p>


                </div>
                <div class="card-footer text-muted">
                </div>

            </div>
        </div>

        <!-- Mill Data ---->
        <div class="card ">
            <div class="card-header" id="RollDataHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#RollDataBody" aria-expanded="false" aria-controls="RollDataBody">
                        MILL DATA
                    </button>
                </h5>
            </div>
            <div class="collapse" id="RollDataBody" aria-labelledby="RollDataHeader" data-parent="#accordionAccuband">
                <div class="card card-body">
                    <form>
                        <div class="row">

                            <div class="col-sm-8 text-left">

                                <div class="card-title">Enter Roll Table Data</div>
                                <div class="formDivA">
                                    <!-- Input Roll Length Width
                <div class="input-group mb-3 input-group-lg">    -->
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"> Roll Length:</span>
                                        </div>
                                        <input type="number" class="form-control" id="RollLength" value="1800" required>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"> Overscan:</span>
                                        </div>
                                        <input type="number" class="form-control" id="AB6Overscan" value="10" required>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> % </span>
                                        </div>
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"> HOP:</span>
                                        </div>
                                        <input type="number" class="form-control" id="AB6HOP" value="450" required>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>
                                    <!-- Input Roll Pitch Width -->
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"> Roll Pitch:</span>
                                        </div>
                                        <input type="number" class="form-control" id="RollPitch" value="900" required>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"> Roll Diameter:</span>
                                        </div>
                                        <input type="number" class="form-control" id="RollDiameter" placeholder="">
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>

                                    <div id="backLightMillDataEntry">
                                        <div class="input-group mb-3 input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">BackLight Distance Below Pass Line:</span>
                                            </div>
                                            <input type="number" class="form-control" id="backLightDistance" value="1000">

                                            <div class="input-group-append">
                                                <span class="input-group-text"> mm </span>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="Leave Platform Height blank for new installation">Existing Platform Height:</span>
                                        </div>
                                        <input type="number" class="form-control" id="existingPlatformHeight">
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>


                                </div>

                                <button class="btn btn-info" type="button" onclick="AB6Calculation();">ACCEPT</button>

                     

                            </div>

                            <div class="col-sm-4 text-left">
                                <div class="card-title">Results</div>
                                <div class="formDivC" id="millDataResultID">
                                    <!-- some code here by JS-->

                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Installation Height:</span>
                                        </div>
                                        <input type="number" class="form-control" id="InstallationHeight" disabled>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>

                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Platform Height:</span>
                                        </div>
                                        <input type="number" class="form-control" id="calculatedPlatformHeight" disabled>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>

                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Field Of view:</span>
                                        </div>
                                        <input type="number" class="form-control" id="FieldofView" disabled>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>
                                    <div id="backLightMillDataResult">
                                        <div class="input-group mb-3 input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">FOV @ Backlight:</span>
                                            </div>
                                            <input type="number" class="form-control" id="FOVBackLight" disabled>
                                            <div class="input-group-append">
                                                <span class="input-group-text"> mm </span>
                                            </div>
                                        </div>
                                        <div class="input-group mb-3 input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">BackLight Size:</span>
                                            </div>
                                            <input type="text" class="form-control" id="BackLightSize" disabled>
                                            <input type="number" class="form-control" id="LitLength" disabled>

                                            <div class="input-group-append">
                                                <span class="input-group-text"> mm </span>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>

                        </div>
                    </form>
                        <p class="card-text">
                            A Link to standard Mill Drawing
                        </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!--SCANNER HEAD ---->
        <div class="card ">
            <div class="card-header" id="ScannerHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#ScannerHeadBody" aria-expanded="false" aria-controls="ScannerHeadBody">
                        SCANNER HEAD
                    </button>
                </h5>
            </div>
            <div id="ScannerHeadBody" class="collapse" aria-labelledby="ScannerHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <form>
                        <div class="row">
                            <div class="col-sm-5 text-left">

                                <div class="card-title">Scanner Head Options</div>
                                <div class="formDivA" id="scannerHeaderID">
                                    <!-- select Scanner Support -->
                                    <!-- select Air Purging Nozzle -->



                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="M/C is required for 80m and above">Distance to Cabinet:</span>
                                        </div>
                                        <input type="number" class="form-control" id="DistancePSEU" value="80" required>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> m </span>
                                        </div>
                                    </div>



                                </div>
                            </div>
                            <div class="col-sm-7 text-left">
                                <div class="card-title">Results</div>
                                <table class="table table-bordered" id="tableItemA">
                                    Summary of Item A will be listed here based on selection
                                </table>
                            </div>
                        </div>
                    </form>

                    <p class="card-text">
                        A link to Standard Drawing Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!-- Accuband Floor Mounted Cabinet Design ---->
        <div class="card ">
            <div class="card-header" id="AccubandFMCHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#AccubandFMCBody" aria-expanded="false" aria-controls="AccubandFMCBody">
                        ACCUBAND FLOOR MOUNTED CABINET
                    </button>
                </h5>
            </div>
            <div id="AccubandFMCBody" class="collapse" aria-labelledby="AccubandFMCHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                        <div class="row">
                            <div class="col-sm-5 text-left">
                                <form id="ItemBFMC2100ID">

                                    <div class="formDivB">
                                        <div id="AccubandCabinetOptions">

                                            <div id="selectItemB1Option">
                                                <!--some js code here-->
                                            </div>
                                            <div id="selectItemB2Option">
                                                <!--some js code here-->
                                            </div>


                                            <div id="ItemBFMCIncluded">
                                                <div class="input-group mb-3 input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="M/C is required for 100m and above">Distance to Scanner Power Supply:</span>
                                                    </div>
                                                    <input type="number" class="form-control" id="DiscreteDistance" value="100" required>

                                                    <div class="input-group-append">
                                                        <span class="input-group-text"> m </span>
                                                    </div>

                                                </div>
                                                <div class="input-group mb-3 input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="M/C is required for 100m and above">Distance to Level 2:</span>
                                                    </div>
                                                    <input type="number" class="form-control" id="DistanceEUL2" value="100" required>

                                                    <div class="input-group-append">
                                                        <span class="input-group-text"> m </span>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="btn btn-info" type="button" onclick="prepItemB();">ACCEPT</button>
                                </form>

                            </div>

                            <div class="col-sm-7 text-left">
                                <div class="card-title">Results</div>
                                <table class="table table-bordered" id="tableItemB">
                                </table>
                                <p> Summary of Item B will be listed here based on selection</p>
                            </div>

                        </div>
                    <p class="card-text">
                        A link to Standard Drawing Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!-- Accuband Calibrator ---->
        <div class="card ">
            <div class="card-header" id="CalibratorHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#CalibratorBody" aria-expanded="false" aria-controls="CalibratorBody">
                        CALIBRATOR AND CALIBRATOR CARRIER
                    </button>
                </h5>
            </div>
            <div id="CalibratorBody" class="collapse" aria-labelledby="CalibratorHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-5 text-left" id="selectCalibrator">

                        </div>
                        <div class="col-sm-7 text-left">
                            <div class="card-title">Results</div>
                            <table class="table table-bordered" id="tableItemC">
                            </table>
                        </div>

                    </div>
                    <p class="card-text">
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!-- Accuband Operator PC Option ---->
        <div class="card ">
            <div class="card-header" id="OperatorHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#OperatorBody" aria-expanded="false" aria-controls="OperatorBody">
                        OPERATOR'S STATION
                    </button>
                </h5>
            </div>
            <div id="OperatorBody" class="collapse" aria-labelledby="OperatorHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <form>
                        <div class="row">
                            <div class="col-sm-5 text-left">
                                <div class="card-title">Select Operator's PC options</div>
                                <div class="formDivB">

                                    <div class="input-group mb-3 input-group">

                                        <div class="input-group-prepend">
                                            <label class="input-group-text">Operator's Station</label>
                                        </div>

                                        <select class="custom-select" id="selKIPQTY" name="selKIPQTY">
                                            <option value="0" disabled selected>QTY</option>
                                            <option value="0">0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>

                                        <select class="custom-select" id="selectedPC" name="selectedPC">
                                            <option value="YES">KELK 1U PC</option>
                                            <option value="NO">KIP ONLY</option>
                                        </select>
                                        <select class="form-control custom-select" id="ItemDVoltage">
                                        </select>

                                    </div>

                                    <div class="input-group mb-3 input-group">

                                        <div class="input-group-prepend">
                                            <label class="input-group-text" for="inputGroupSelect04">Desktop Media Converotrs</label>
                                        </div>

                                        <select class="custom-select" id="operatorMCQTY">
                                            <option value="0" disabled selected>QTY</option>
                                            <option value="0">0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </div>
                                </div>
                                <button class="btn btn-info" type="button" onclick="prepItemD();">ACCEPT</button>
                            </div>

                            <div class="col-sm-7 text-left">
                                <div class="card-title">Results</div>
                                <table class="table table-bordered" id="tableItemD">
                                </table>
                                <p> Summary of Item D will be listed here based on selection</p>
                            </div>

                        </div>
                    </form>
                    <p class="card-text">
                        A link to Standard Drawing Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!-- Accuband BackLight  Option ---->
        <div class="card ">
            <div class="card-header" id="BackLightHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#BackLightBody" aria-expanded="false" aria-controls="BackLightBody">
                        LOW PROFILE LED BACKLIGHT
                    </button>
                </h5>
            </div>
            <div id="BackLightBody" class="collapse" aria-labelledby="BackLightHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-5 text-left">
                            <div class="card-title">Select Backlight Orientation</div>
                            <div class="formDivA">
                                <div class="input-group mb-3 input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">BackLight Orientation:</span>
                                    </div>
                                    <select class="form-control custom-select" id="backLightOrientation">
                                    </select>
                                </div>
                            </div>
                            <button class="btn btn-info" type="button" onclick="prepItemE();">ACCEPT</button>

                        </div>
                        <div class="col-sm-7 text-left">
                            <div class="card-title">Results</div>
                            <table class="table table-bordered" id="tableItemE">
                            </table>
                            <p> Summary of Item B will be listed here based on selection</p>
                        </div>

                    </div>
                    <p class="card-text">
                        A link to Standard Drawing Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!--ASDH  Options-->
        <div class="card ">
            <div class="card-header" id="AccuspeedHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#AccuspeedBody" aria-expanded="false" aria-controls="AccuspeedBody">
                        ACCUSPEED ASDH
                    </button>
                </h5>
            </div>
            <div id="AccuspeedBody" class="collapse" aria-labelledby="AccuspeedHeader" data-parent="#accordionAccuband">
                <div class="card-body">

                    <div id="ASDHOption1">
                        <div class="row">

                            <div class="col-sm-5 text-left">
                                <div class=" card-title">Accuspeed</div>
                                <div class="formDivA" id="formASDH1">
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Sensor Location</span>
                                        </div>
                                        <input type="text" class="form-control" id="ASDHLocation1" placeholder="Three Letter/Digits Location Code enter here">

                                    </div>
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Optics Head Cable Length</span>
                                        </div>
                                        <input type="number" class="form-control" id="ASDHCableLength1" value="15">
                                        <div class="input-group-append">
                                            <span class="input-group-text"> m </span>
                                        </div>
                                    </div>
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Distance From ASDH PowerSupply to EU</span>
                                        </div>
                                        <input type="number" class="form-control" id="ASDHPSDistance1" value="80">
                                        <div class="input-group-append">
                                            <span class="input-group-text"> m </span>
                                        </div>
                                    </div>

                                    <!-- Configure OH -->
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Optics Head</span>
                                        </div>
                                        <select class="form-control custom-select" id="ASDHOH1">
                                        </select>
                                        <select class="form-control custom-select" id="ASDHNozzle1">
                                        </select>
                                        <select class="form-control custom-select" id="ASDHMount1">
                                        </select>
                                    </div>

                                    <!-- Configure EU -->
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">ASDH EU</span>
                                        </div>
                                        <select class="form-control custom-select" id="ASDEUAO1">
                                        </select>


                                        <select class="form-control custom-select" id="ASDEUQO1">
                                        </select>

                                        <select class="form-control custom-select" id="ASDEUFieldBus1">
                                        </select>
                                    </div>
     
                                </div>
                                <button class="btn btn-info" type="button" onclick="validateASDH(1);">ACCEPT</button>
                                <button class="btn btn-info" type="button" onclick="secondASDHOption();" id="secondASDH" value="ADD">ADD 2nd ASDH</button>

                            </div>
                            <div class="col-sm-7 text-left">
                                <div class="card-title">Results</div>
                                <table class="table table-bordered" id="tableItemF1">
                                </table>
                                <p> Summary of Item F will be listed here based on selection</p>
                            </div>


                        </div>
                    </div>
                    <div id="ASDHOption2">
                        <div class="row">

                            <div class="col-sm-5 text-left">
                                <div class=" card-title">Accuspeed #2 </div>
                                <div class="formDivA" id="formASDH2">
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Sensor Location</span>
                                        </div>
                                        <input type="text" class="form-control" id="ASDHLocation2" placeholder="CSE">

                                    </div>
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Optics Head Cable Length</span>
                                        </div>
                                        <input type="number" class="form-control" id="ASDHCableLength2" value="15">
                                        <div class="input-group-append">
                                            <span class="input-group-text"> m </span>
                                        </div>
                                    </div>
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Distance From ASDH PowerSupply to EU</span>
                                        </div>
                                        <input type="number" class="form-control" id="ASDHPSDistance2" value="80">
                                        <div class="input-group-append">
                                            <span class="input-group-text"> m </span>
                                        </div>
                                    </div>

                                    <!-- Configure OH -->
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Optics Head</span>
                                        </div>
                                        <select class="form-control custom-select" id="ASDHOH2">
                                        </select>
                                        <select class="form-control custom-select" id="ASDHNozzle2">
                                        </select>
                                        <select class="form-control custom-select" id="ASDHMount2">
                                        </select>
                                    </div>

                                    <!-- Configure EU -->
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">ASDH EU</span>
                                        </div>
                                        <select class="form-control custom-select" id="ASDEUAO2">
                                        </select>
                                        <select class="form-control custom-select" id="ASDEUQO2">
                                        </select>
                                        <select class="form-control custom-select" id="ASDEUFieldBus2">
                                        </select>
                                    </div>

                                </div>
                                <button class="btn btn-info" type="button" onclick="validateASDH(2);">ACCEPT</button>
                            </div>
                            <div class="col-sm-7 text-left">
                                <div class="card-title">Results</div>
                                <table class="table table-bordered" id="tableItemF2">
                                </table>
                                <p> Summary of Item F will be listed here based on selection</p>
                            </div>

                        </div>
                    </div>

                    <p class="card-text">
                        A link to Standard Drawing Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!--HMD2048  Options-->
        <div class="card ">
            <div class="card-header" id="HMD2048Header">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#HMD2048Body" aria-expanded="false" aria-controls="HMD2048Body">
                        ACCUSCAN HMD2048
                    </button>
                </h5>
            </div>
            <div id="HMD2048Body" class="collapse" aria-labelledby="HMD2048Header" data-parent="#accordionAccuband">
                <div class="card-body">

                    <div class="row">
                        <div class="col-sm-5 text-left">
                            <div class=" card-title">Enter Mill Info</div>
                            <form>
                                <div class="formDivA">
                                    <!-- Input Roll Length Width -->
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"> Roll Length:</span>
                                        </div>
                                        <input type="number" class="form-control" id="HMD2048RollLength" value="1800" required>

                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>

                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="Leave Preferred Height blank for new installation">Prefered Installation Height:</span>
                                        </div>
                                        <input type="number" class="form-control" id="HMD2048PreferredHeight">
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>

                                </div>
                                <button class="btn btn-primary btn" type="button" onclick="HMDCalculation();" >Calculate</button>
                                <br />
                                <div class=" card-title">Calculation Results</div>
                                <div class="formDivC">
                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Focus Length:</span>
                                        </div>
                                        <input type="number" class="form-control" id="HMD2048FocusLength" placeholder="50" disabled>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>

                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Installation Height:</span>
                                        </div>
                                        <input type="number" class="form-control" id="HMD2048InstallationHeight" disabled>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>

                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Field Of view:</span>
                                        </div>
                                        <input type="number" class="form-control" id="HMD2048FieldofView" placeholder="1980" disabled>
                                        <div class="input-group-append">
                                            <span class="input-group-text"> mm </span>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="col-sm-7 text-left">
                            <div class="card-title">Results</div>
                            <table class="table table-bordered" id="tableItemM">
                            </table>
                            <p> Summary of Item M will be listed here based on selection</p>
                        </div>

                    </div>

                    <p class="card-text">
                        A link to Standard Drawing Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!--Accucrop  Options-->
        <div class="card ">
            <div class="card-header" id="AccucropHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#AccucropBody" aria-expanded="false" aria-controls="AccucropBody">
                        ACCUCROP
                    </button>
                </h5>
            </div>
            <div id="AccucropBody" class="collapse" aria-labelledby="AccucropHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-5 text-left">
                            <div class="card-title">Accucrop Options</div>

                            <form id="AccubandCabinetOptions">
                                <div class="formDivB">

                                    <div id="selectItemP1Option">

                                    </div>

                                    <div class="input-group mb-3 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Discrete Option:</span>
                                        </div>

                                        <select class="custom-select" id="ACR3WAGOInput" name="ACR3WAGOInput">
                                        </select>

                                        <select class="custom-select" id="ACR3WAGOOutput" name="ACR3WAGOOutput">
                                        </select>

                                    </div>



                                    <div id="ItemPFMCIncluded">
                                        <div class="input-group mb-3 input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="M/C is required for 100m and above">Distance to AB6 Cabinet</span>
                                            </div>
                                            <input type="number" class="form-control" id="DistanceAB6" value="100" required>
                                            <div class="input-group-append">
                                                <span class="input-group-text"> m </span>
                                            </div>
                                        </div>

                                    </div>



                                </div>
                            </form>


                            <button class="btn btn-info" type="button" onclick="prepItemP();">ACCEPT</button>

                        </div>

                        <div class="col-sm-7 text-left">
                            <div class="card-title">Results</div>
                            <table class="table table-bordered" id="tableItemP">
                            </table>
                            <p> Summary of Item P will be listed here based on selection</p>
                        </div>

                    </div>
                    <p class="card-text">
                        A link to Standard Drawing Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>



        </div>


        <!--Additional Feature -->
        <div class="card ">
            <div class="card-header" id="ItemGHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#ItemGBody" aria-expanded="false" aria-controls="ItemGBody">
                        ADDITIONAL FEATURES
                    </button>
                </h5>
            </div>
            <div id="ItemGBody" class="collapse" aria-labelledby="ItemGHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-5 text-left">
                            <div class="formDivB">
                                <div id="AccubandItemG">
                                </div>
                                <div id="AccucropItemG">
                                </div>

                            </div>
                            <button class="btn btn-info" type="button" onclick="prepItemG();">ACCEPT</button>
                        </div>
                        <div class="col-sm-7 text-left">
                            <div class="card-title">Results</div>
                            <table class="table table-bordered" id="tableItemG">
                            </table>
                        </div>
                    </div>

                    <p class="card-text">
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>



        <!--Software  Options-->
        <div class="card ">
            <div class="card-header" id="SoftwareHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#SoftwareBody" aria-expanded="false" aria-controls="SoftwareBody">
                        SOFTWARE FEATURES
                    </button>
                </h5>
            </div>
            <div id="SoftwareBody" class="collapse" aria-labelledby="SoftwareHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-5 text-left">
                            <div class="formDivB">
                                <div class="input-group mb-3 input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Host Communication Protocol:</span>
                                    </div>
                                    <select class="form-control custom-select" id="selectWidthGageHCP">
                                    </select>
                                    <select class="form-control custom-select" id="selectImageGageHCP">
                                    </select>
                                </div>
                                <div id="AccucropSoftware">


                                </div>
                                <div id="commonSoftware">


                                </div>
                            </div>
                                <button class="btn btn-info" type="button" onclick="prepItemS();">ACCEPT</button>
                            </div>
                        <div class="col-sm-7 text-left">
                            <div class="card-title">Results</div>
                            <table class="table table-bordered" id="tableItemS">
                            </table>
                            <p> Summary of Item P will be listed here based on selection</p>
                        </div>
                    </div>

                    <p class="card-text">
                        A link Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

        <!--  Field Service Notes-->
        <div class="card ">
            <div class="card-header" id="FieldServiceHeader">
                <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#FieldServiceBody" aria-expanded="false" aria-controls="FieldServiceBody">
                        FIELD SERVICE & COMMISSIONING
                    </button>
                </h5>
            </div>
            <div id="FieldServiceBody" class="collapse" aria-labelledby="FieldServiceHeader" data-parent="#accordionAccuband">
                <div class="card-body">
                    <div class="row">

                        <div class="col-sm-6 text-left">

                            <div class="d-none card-title">Field Service Notes</div>

                            <div class="input-group mb-3 input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"> Field Service Notes:</span>
                                </div>
                                <textarea class="form-control" rows="5" id="FieldServiceNotes" name="text"></textarea>

                            </div>

                        </div>

                    </div>

                    <p class="card-text">
                        A link Here
                    </p>
                </div>
                <div class="card-footer text-muted">
                    <button class="btn btn-primary" type="button" onclick="navigate('PREV');">PREVIOUS</button>
                    <button class="btn btn-primary" type="button" onclick="navigate('NEXT');">NEXT</button>
                </div>

            </div>
        </div>

    </div>
    <div class="row">
        <div class="col-7 text-left">
            <br />
            <button class="btn btn-primary btn" type="submit" id="workorderButton" onclick="showWorkOrderInfo();" data-toggle="tooltip" data-placement="top" title="">Generate WorkOrder</button>

            <br />


            <div id="WorkOrderInfo">
                <div class="formDivA">
                    <div class="input-group mb-3 input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Quotation Number:</span>
                        </div>
                        <input type="text" class="form-control" id="Quotation">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Work Order Number:</span>
                        </div>
                        <input type="text" class="form-control" id="WorkOrder">
                    </div>
                    <div class="input-group mb-3 input-group">

                        <div class="input-group-prepend">
                            <span class="input-group-text">Folder Date:</span>
                        </div>
                        <input type="date" class="form-control" id="folderDate">


                        <div class="input-group-prepend">
                            <span class="input-group-text">MFG Date:</span>
                        </div>
                        <input type="date" class="form-control" id="mfgDate">

                        <div class="input-group-prepend">
                            <span class="input-group-text">Shipping Date</span>
                        </div>
                        <input type="date" class="form-control" id="shippingDate">



                    </div>
                    <div class="input-group mb-3 input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">First Crate Number:</span>
                        </div>
                        <input type="number" class="form-control" id="firstCrateNumber" value="1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Last Crate Number</span>
                        </div>
                        <input type="number" class="form-control" id="lastCrateNumber" disabled>
                    </div>
                </div>
                <button class="btn btn-info" type="button" onclick="continueWorkOrder();">CONTINUE</button>
            </div>






        </div>

    </div>


</body>
</html>


<script>

    document.addEventListener('input', (e) => {

        if (e.target.getAttribute('name') == "ProductType")
            setProductVive();
            // console.log(e.target.value);
//            alert($("input[name='ProductType']:checked").val());

        if (e.target.getAttribute('id') == "selectModeOfOperation") {
            document.getElementById("selectModeOfOperation").style.color = 'black';
            setBLView();
        }

        if (e.target.getAttribute('id') == "gageLOcation") {
            document.getElementById("gageLOcation").style.color = 'black';
            ASDHLocation1
            document.getElementById("ASDHLocation1").value = document.getElementById("gageLOcation").value;

        }
        if (e.target.getAttribute('id') == "selectOpticsKit") {
            document.getElementById("selectOpticsKit").style.color = 'black';
            setBLView();
        }
        if (e.target.getAttribute('id') == "selectScannerSupport") {
            document.getElementById("selectScannerSupport").style.color = 'black';
            validateScannerHead();

        }
        if (e.target.getAttribute('id') == "selectAirNozzle") {
            document.getElementById("selectAirNozzle").style.color = 'black';
            validateScannerHead();
        }

        if (e.target.getAttribute('id') == "ItemBFMCSupplyOption") {
            validateItemB('0');
            $("#AccubandCabinetOptions :input").prop("disabled", false); // enable  all element in a form after change
            document.getElementById("AccubandFMCPCTitle").disabled = true;
        }


        if (e.target.getAttribute('id') == "ItemBVoltage") {
            document.getElementById("ItemBVoltage").style.color = 'black';
        }
        if (e.target.getAttribute('id') == "ItemBDoorType") {
            document.getElementById("ItemBDoorType").style.color = 'black';
        }
        if (e.target.getAttribute('id') == "ItemBVentilation") {
            document.getElementById("ItemBVentilation").style.color = 'black';
        }
        if (e.target.getAttribute('id') == "DistanceEUL2") {
            document.getElementById("DistanceEUL2").style.color = 'black';
        }

        if (e.target.getAttribute('id') == "AB6WAGOInput") {
            document.getElementById("AB6WAGOInput").style.color = 'black';
        }

        if (e.target.getAttribute('id') == "AB6WAGOOutput") {
            document.getElementById("AB6WAGOOutput").style.color = 'black';
        }

        if (e.target.getAttribute('id') == "AccubandWAGOWOID") {
            document.getElementById("AccubandWAGOWOID").style.color = 'black';
        }
        if (e.target.getAttribute('id') == "DiscreteDistance") {
            document.getElementById("DiscreteDistance").style.borderColor = 'lightgrey';
        }
        if (e.target.getAttribute('id') == "CalibratorChecked") {
            if (document.getElementById("CalibratorChecked").checked) {
                prepItemC();
            } else {
                ItemC = [[]];
                clearTable('tableItemC');
            }
        }
   
        if (e.target.getAttribute('id') == "DistancePSEU") {
            validateScannerHead();
        }
        
    })

    $(document).ready(function () {   //same as: $(function() {

        Applications.forEach((item) => {
            insertRadioButton('ApplicationID', "ProductType", item);
        })

        Selections.forEach((item) => {
            switch (item.length) {
                case 4:
                    insertSelectionID(item[0], item[1], item[2], item[3]);
                    break;
                case 5:
                    insertSelectionID(item[0], item[1], item[2], item[3], item[4]);
                    break;
                case 6:
                    insertSelectionID(item[0], item[1], item[2], item[3], item[4], item[5]);
                    break;
                case 7: // not happens
                    insertSelectionID(item[0], item[1], item[2], item[3], item[4], item[5],item[6]);
                    break;
                case 8: // add text and place holder
                    insertSelectionID(item[0], item[1], item[2], item[3], item[4], item[5], item[6],item[7]);
                    break;
                case 9: // add text and place holder
                    insertSelectionID(item[0], item[1], item[2], item[3], item[4], item[5], item[6], item[7],item[8]);
                    break;
                default:
                    alert('not defined size: selections');
            }
   
        })

        Object.keys(oSelectionChoices).forEach((key) => {
            insertOptions(oSelectionChoices[key]);
        })

        $("#AccubandCabinetOptions :input").prop("disabled", true); // disable all element in a form before selection
        

        setProductVive();
        document.getElementById("AccubandWAGOWOID").style.display = 'none';

        

        setBLView();

 //       insertTableRow('tableItemA', ItemHeader, "HEADER");

        
//        insertSelections('#selectModeOfOperation', oC965.Mode, 'Choose ....');
        insertSelections('#gageLOcation', oLocation, 'Choose ....');

//        insertSelections('#selectOpticsKit', oC965.OpticsKit, 'Choose Optics Kits');
//        insertSelections('#selectScannerSupport', oC965.Support, 'Select Scanner Support');
//        insertSelections('#selectAirNozzle', oC965.Nozzle, 'Select Air Nozzle Type');
        insertSelections('#ItemBFMCSupplyOption', oCabinet.Options, 'Select Accuband Cabinet Option');
        insertSelections('#ItemBDoorType', oCabinet.DoorType, 'Door Type');
        insertSelections('#ItemBVentilation', oCabinet.Ventilation, 'Ventilation');
        insertSelections('#ItemBVoltage', oCabinet.ACVoltage, 'AC Power');
        insertSelections('#AB6WAGOOutput', oCabinet.WAGOIO, 'Output');
        insertSelections('#AB6WAGOInput', oCabinet.WAGOIO, 'Input');

        insertSelections('#ItemPDoorType', oCabinet.DoorType, 'Door Type');
        insertSelections('#ItemPVentilation', oCabinet.Ventilation, 'Ventilation');
        insertSelections('#ItemPVoltage', oCabinet.ACVoltage, 'AC Power');
        insertSelections('#ACR3WAGOOutput', oCabinet.WAGOIO, 'Output');
        insertSelections('#ACR3WAGOInput', oCabinet.WAGOIO, 'Input');



        insertSelections('#ItemDVoltage', oCabinet.ACVoltage, 'AC Power');

        insertSelections('#backLightOrientation', oBackLight.Orientation, 'Choose Orietation');

        insertSelections('#ASDHOH1', oASDH.StandOff, 'StandOff Distance');
        insertSelections('#ASDHOH2', oASDH.StandOff, 'StandOff Distance');

        insertSelections('#ASDHNozzle1', oASDH.Nozzle, 'Choose a Nozzle');
        insertSelections('#ASDHNozzle2', oASDH.Nozzle, 'Choose a Nozzle');
        insertSelections('#ASDHMount1', oASDH.Mount, 'Monting Type');
        insertSelections('#ASDHMount2', oASDH.Mount, 'Monting Type');

        insertSelections('#ASDEUAO1', oASDH.Analog, 'Number of AO');
        insertSelections('#ASDEUAO2', oASDH.Analog, 'Number of AO');

        insertSelections('#ASDEUQO1', oASDH.Quadrature, 'Number of QO');
        insertSelections('#ASDEUQO2', oASDH.Quadrature, 'Number of QO');

        insertSelections('#ASDEUFieldBus1', oASDH.FieldBus, 'Addition FieldBus');
        insertSelections('#ASDEUFieldBus2', oASDH.FieldBus, 'Addition FieldBus');



        insertSelections('#selectWidthGageHCP', oSoftware.HCPwidth, 'Choose HCP...');
        insertSelections('#selectImageGageHCP', oSoftware.HCPimage, 'Choose HCP...');

        insertSelections('#selectINCEncoder', oItemG.INCencoder, 'Choose A Incremental Encoder');
        insertSelections('#selectABSEncoder', oItemG.ABSencoder, 'Choose A Absolute Encoder');

        Object.keys(oItemGCheckList).forEach((key) => {
            insertCheckList(oItemGCheckList[key]);
        })
        Object.keys(oCheckList).forEach((key) => {
            insertCheckList(oCheckList[key]);
        })
        Object.keys(oItemSCheckList).forEach((key) => {
            insertCheckList(oItemSCheckList[key]);
        })
        document.getElementById("TS511Checked").checked = document.ApplicationForm.ProductType.value=='CLOSEDLOOP';

    });


 
    function insertCheckList(obj) { // htmlID, arr, dValue, titleID) {
        var order = obj['ID'][3];
        var htmlID = obj['ID'][0];
        var itemID = obj['ID'][1];
        var dValue = obj['ID'][2];
        var  itemTitle= obj['Value'][3];
        var strHTML = '<div class="input-group mb-3"><div class="input-group-prepend"><div class="input-group-text"><input type="checkbox" id="' + itemID + '" ' + dValue + '></div ></div>';
        strHTML += '<span class="input-group-text" >' + itemTitle + '</span></div>';
        //for example: selectID = #selectAirNozzle; obj=AccubandNozzle
        if (order)
            strHTML = document.getElementById(htmlID).innerHTML + strHTML;
        else
            strHTML += document.getElementById(htmlID).innerHTML;

        document.getElementById(htmlID).innerHTML=strHTML;
    }



    function insertCheckBox(htmlID,arr,dValue,titleID) {
        var itemID = arr[0];
        var itemTitle = arr[3];
        var strHTML = '<div class="input-group mb-3 input-group"><div class="input-group-prepend"><div class="input-group-text"><input type="checkbox" id="' + itemID + '" ' + dValue + '></div ></div>';
        strHTML += '<input type = "text" value="' + itemTitle + '" ' + ((titleID == '' )? ' ' : 'id="' + titleID + '"') + ' disabled ></div>';
        //for example: selectID = #selectAirNozzle; obj=AccubandNozzle
        $(htmlID).append(strHTML);
       // alert(document.getElementById(htmlID).innerHTML);
    }



    function insertSelections(selectID, obj, title) {
        //for example: selectID = #selectAirNozzle; obj=AccubandNozzle
        var isDisabled;
        $(selectID).append('<option value="" disabled selected>' + title + '</option>');

        Object.keys(obj).forEach((key) => {
            isDisabled = ((obj[key][0].length == 0) ? 'disabled' : '');
            $(selectID).append('<option value="' + obj[key][0] + '" ' + isDisabled + '>' + obj[key][3] + '</option>');
        })

    }

    function insertOptions(obj) {
        //for example: selectID = #selectAirNozzle; obj=AccubandNozzle
        var isDisabled;
        var selectID = obj['ID'][0];
        var title = obj['ID'][1];;
        var strHTML = '<option value="" >' + title + '</option>';

        //$(selectID).append('<option value="" disabled selected>' + title + '</option>');

        Object.keys(obj['Options']).forEach((key) => {
 
            isDisabled = ((obj['Options'][key][0].length == 0) ? 'disabled' : '');
               //$(selectID).append('<option value="' + obj[key][0] + '" ' + isDisabled + '>' + obj[key][3] + '</option>');
            strHTML += '<option value="' + obj['Options'][key][0] + '" ' + isDisabled + '>' + obj['Options'][key][3] + '</option>';
        
        })
        document.getElementById(selectID).innerHTML = strHTML;

    }

    function insertRadioButton(ID, selectName, arr) {

        var strHTML = '<div class="input-group">';
        strHTML += '<div class="input-group-prepend">';
        strHTML += '<div class="input-group-text">';
        strHTML += '<input type="radio" name="' + selectName + '" value="' + arr[0] + '"' + arr[1] + '>';
        strHTML += '</div></div>';
        strHTML += '<input type="text" class="form-control" value="' + arr[2] + '" disabled';
        strHTML += '></div>';
        document.getElementById(ID).innerHTML += strHTML;
    }

    function insertSelectionID(htmlID, divID, title, selectID1='', selectID2 = '', selectID3 = '',textID='',placeholder='',unit='') {
        var strHTML = (divID == '') ? ('<div>') : ('<div id="' + divID + '">');
        strHTML += '<div class="input-group mb-3 ">';
        strHTML += '<div class="input-group-prepend">';
        strHTML += '<label class="input-group-text" >' + title + '</label>';
        strHTML += '</div>';
        if (selectID1 != '') strHTML += '<select class="selectpicker form-control" id="' + selectID1 + '" required> </select>';
        if (selectID2 != '') strHTML += '<select class="custom-select" id="' + selectID2 + '"> </select>';
        if (selectID3 != '') strHTML += '<select class="custom-select" id="' + selectID3 + '"> </select>';
        if (textID != '') strHTML += '<input type="text" class="form-control custom-select" id="' + textID + '" placeholder="' + placeholder + '">';
        if (unit != '') strHTML += '<div class="input-group-append"><span class="input-group-text">'+unit+ '</span></div>';

        strHTML += '</div>';

        strHTML += '</div>';
        document.getElementById(htmlID).innerHTML = strHTML + document.getElementById(htmlID).innerHTML;
    }

    function getDisplay(isTrue) {
        if (isTrue) {
            return ('block');
        } else {
            return ('none');
        }
    }


    function setProductVive() { // set default product view layout (visibility)
        var sType = document.ApplicationForm.ProductType.value;
        var isWidthGage = (sType == "WIDTHGAGE");
        var isImageGage = (sType == "IMAGEGAGE");
        var isOpenLoop = (sType == "OPENLOOP");
        var isClosedLoop = (sType == "CLOSEDLOOP");
        var isHMD = (sType == 'HMD2048');

        document.getElementById("RollDataHeader").style.display = 'block';
     
        document.getElementById("AccubandFMCHeader").style.display = 'block';

        //IR/BL/FL options
        document.getElementById("ModeConfiguration").style.display = getDisplay(isWidthGage);
        document.getElementById("selectModeOfOperation").disabled = !isWidthGage;
        //      document.getElementById("selectModeOfOperation").value = "0";

        setBLView();


 //       document.getElementById("AccubandWAGOWOID").style.display = 'none';
        document.getElementById("DistanceEUL2").style.borderColor = 'lightgrey';
        document.getElementById("DiscreteDistance").style.borderColor = 'lightgrey';
        document.getElementById("AccubandWAGOWOID").style.borderColor = 'lightgrey';
        document.getElementById("DistancePSEU").style.borderColor = 'lightgrey';

        

        document.getElementById("RXCSEConfiguration").style.display = getDisplay(!isWidthGage);

        document.getElementById("BackLightHeader").style.display = 'none';

        document.getElementById("AccuspeedHeader").style.display = getDisplay(!isWidthGage);
        document.getElementById("ASDHOption1").style.display = "block";
        document.getElementById("ASDHOption2").style.display = "none";

        document.getElementById("HMD2048Header").style.display = getDisplay(isClosedLoop || isOpenLoop);
        document.getElementById("AccucropHeader").style.display = getDisplay(isClosedLoop);


        document.getElementById("AccubandItemG").style.display = getDisplay(isWidthGage || isImageGage || isClosedLoop || isOpenLoop);
        document.getElementById("AccucropItemG").style.display = getDisplay(isClosedLoop);


        //HCP selection
        document.getElementById("selectWidthGageHCP").style.display = getDisplay(isWidthGage);
        document.getElementById("selectImageGageHCP").style.display = getDisplay(!isWidthGage);

        document.getElementById("AccucropSoftware").style.display = getDisplay(isClosedLoop);

        document.getElementById("WorkOrderInfo").style.display = 'none';

 
//
        
    }
    function setBLView() {
        var isBackLight = (document.getElementById("selectModeOfOperation").value == "B");
        document.getElementById("BackLightHeader").style.display = getDisplay(isBackLight);
        document.getElementById("backLightMillDataEntry").style.display = getDisplay(isBackLight);
        document.getElementById("backLightMillDataResult").style.display = getDisplay(isBackLight);
    }
    function clearTable(tableName) {
        //POS="HEADER", "BODY"or "TAIL"
        var table = document.getElementById(tableName);
        table.innerHTML = "";
}

    function insertTableRow(tableName, itemArray, POS) {
        //POS="HEADER", "BODY"or "TAIL"
        var table = document.getElementById(tableName);
        var row = '';


        if (POS == "HEADER") {
            row = '<thead class="thead-light"><tr>';
        }
        itemArray.forEach((item, index) => {
            row = row + '<td>' + item + '</td>';
        })

        if (POS == "HEADER") {
            row = row + '</tr> </thead>';

            table.innerHTML = row;
        } else {
            table.innerHTML = table.innerHTML + row;
        }
        // alert('new table.innerHTML='+ table.innerHTML);
    }

    ///===========BUTTONS==================


    function secondASDHOption() {
        if (document.getElementById("secondASDH").value == 'ADD') {
            document.getElementById("secondASDH").innerHTML = "REMOVE 2nd ASDH";
            document.getElementById("secondASDH").value = 'REMOVE';
            document.getElementById("ASDHOption2").style.display = "block";
        } else {
            document.getElementById("secondASDH").innerHTML = "ADD 2nd ASDH";
            document.getElementById("secondASDH").value = 'ADD';
            document.getElementById("ASDHOption2").style.display = "none";
            ItemASDH[1] = [[]];
            clearTable('tableItemF2');
        }
    }

    function navigate(direction) {
        var currentPOS = 0;
        var prePOS;
        var nextPOS;
        var i;
        aMENU.forEach((item, index) => {
            if (window.getComputedStyle(document.getElementById(item[2])).display == 'block') {
                currentPOS = index;
            }
        });
        var curBodyName = '#' + aMENU[currentPOS][2];
        for (i = currentPOS - 1; i >= 0; i--) {

            if (window.getComputedStyle(document.getElementById(aMENU[i][1])).display == 'block') {

                prePOS = i;
                break;
            }
        }
        if (currentPOS == 0) 
            prePOS = 0;
        
        var preBodyName = '#' + aMENU[prePOS][2];

        for (i = currentPOS + 1; i < aMENU.length; i++) {

            if (window.getComputedStyle(document.getElementById(aMENU[i][1])).display == 'block') {
                nextPOS = i;
                break;
            }
        }
        if (currentPOS == aMENU.length - 1) 
            nextPOS = aMENU.length - 1;
        
        var nextBodyName = '#' + aMENU[nextPOS][2];

        if ((direction == 'PREV') && (currentPOS > 0)) 
            $(preBodyName).collapse("toggle");
        
        if ((direction == 'NEXT') && (currentPOS < aMENU.length-1)) 
            $(nextBodyName).collapse("toggle");
        
        $(curBodyName).collapse("toggle");
  
  }

    function AB6Calculation() {
        var f = document.getElementById("selectOpticsKit").value;
        var FV = document.getElementById("RollLength").value;   //field of view;
        document.getElementById("HMD2048RollLength").value = FV;
        if (f == '') {
            document.getElementById("selectOpticsKit").style.color = 'red';
            return;
        }
        // value read from form:

        var OP = document.getElementById("AB6Overscan").value; //overscan percentage;
        var HOP = document.getElementById("AB6HOP").value; //hop
        var HB = document.getElementById("backLightDistance").value; //backLightDistance
        var existPlatform = document.getElementById("existingPlatformHeight").value; //existingPlatformHeight

        // some fixed value:
        const HAIC = 635; //Air Inlet Chamber Height
        const HCCD = 660; //CCD Height Above Scanner Mounting Plane=660.4 
        const HC = 295; //calibrator mask above passline;
        const CCD = 28.672 * (2048 - 24) / 2048; //ccd length.
        const S = 558.8; //camera separation
        const focalLength = {
            F40: 41.9924757437,
            F50: 50.8034025329,
            F60: 60.6266154737,
            F80: 81.2848080288
        };


        var L = focalLength['F' + f];
        var A = 2 * Math.atan(CCD / (2 * L)) * 180 / Math.PI; // view angle

        var RQF = FV * (1 + OP * 0.01);  // required field of view;
        // values to be calculated :
        var HT = 4217; //camera Height above calibrator to start with;
        var FOVERR = 100000; // Error in Field of View Calculation;


        for (HT = 1000; HT < 10000;) {
            HT = HT + 5;
            var HHOP = HT + HC - HOP;
            var CAMBER = Math.atan(S / (2 * HT)) * 180 / Math.PI;// ATAN(S / (2 * (HT + HC))) * 180 / PI()
            var AA = A / 2 - CAMBER; //Camera A 1st Edge Angle
            var AB = A / 2 + CAMBER;  //Camera A 1st Edge Angle
            var EAA = S / 2 + HHOP * Math.tan(AA * Math.PI / 180);
            var EAB = S / 2 + HHOP * Math.tan(AB * Math.PI / 180);
            var FOV = (EAA >= EAB) ? 2 * EAB : 2 * EAA;
            if (FOVERR > Math.abs(FOV - RQF)) {
                FOVERR = Math.abs(FOV - RQF);
            } else {
                break;
            }
        }

        var platformHeight = HT + HC + L - HAIC - HCCD;

        if (platformHeight < existPlatform) {
            platformHeight = existPlatform;
            HT = platformHeight - HC - L + HAIC + HCCD;

            CAMBER = Math.atan(S / (2 * HT)) * 180 / Math.PI;// ATAN(S / (2 * (HT + HC))) * 180 / PI()
            AA = A / 2 - CAMBER; //Camera A 1st Edge Angle
            AB = A / 2 + CAMBER;  //Camera A 1st Edge Angle
            EAA = S / 2 + HHOP * Math.tan(AA * Math.PI / 180);
            EAB = S / 2 + HHOP * Math.tan(AB * Math.PI / 180);
            FOV = (EAA >= EAB) ? 2 * EAB : 2 * EAA;
        } 
        HT = HT * 1 + HC * 1;
        var WB = Math.abs(2 * (-S / 2 + (HT * 1 + HB * 1) * Math.tan(AB * Math.PI / 180)));

        EAA = S / 2 + HT * Math.tan(AA * Math.PI / 180);
        EAB = S / 2 + HT * Math.tan(AB * Math.PI / 180);
        FOV = (EAA >= EAB) ? 2 * EAB : 2 * EAA;

        document.getElementById("InstallationHeight").value = Math.ceil(HT);
        document.getElementById("calculatedPlatformHeight").value = Math.ceil(platformHeight);
        document.getElementById("FieldofView").value = Math.floor(FOV);
        document.getElementById("FOVBackLight").value = Math.ceil(WB);

        for (var key in oBackLight.Length) {
            var value = parseInt(oBackLight.Length[key][3]);
            if (value > WB) break;
        }
        document.getElementById("BackLightSize").value = oBackLight.Length[key][1];
        document.getElementById("LitLength").value = oBackLight.Length[key][3];


        /**
                <input type="number" class="form-control" id="BackLightSize" disabled>
                    <input type="number" class="form-control" id="Lit Length" disabled>

           **/

    }

    function HMDCalculation() {

        var minHeight = 2400;
        var maxHeight = 4100;
        var PreferredHeight = document.getElementById("HMD2048PreferredHeight").value;
        var Angle = 31.9973;
        var LensFocusLength=50;
        var InstallationHeight;
        var MaximumLength = document.getElementById("HMD2048RollLength").value;

        var CalculateFieldofView;

        

        // calculated installation
        InstallationHeight = 1 / 2 * (MaximumLength * 1.1) / Math.tan(Angle / 2 * Math.PI / 180) + LensFocusLength + 112.6;


        if ((PreferredHeight >= minHeight) && (PreferredHeight < InstallationHeight)) {
            LensFocusLength = 40;
            Angle = 39.4354;
            InstallationHeight = 1 / 2 * (MaximumLength * 1.1) / Math.tan(Angle / 2 * Math.PI / 180) + LensFocusLength + 112.6;
        }

        InstallationHeight = Math.round(InstallationHeight);

        if ((PreferredHeight >= minHeight) && (InstallationHeight < PreferredHeight)) {
            InstallationHeight = PreferredHeight;
        }


        if ((InstallationHeight > maxHeight) && (PreferredHeight < minHeight)) {
            LensFocusLength = 40;
            Angle = 39.4354;
            InstallationHeight = 1 / 2 * (MaximumLength * 1.1) / Math.tan(Angle / 2 * Math.PI / 180) + LensFocusLength + 112.6;
        }

        InstallationHeight = Math.round(InstallationHeight);

        if (InstallationHeight < minHeight) {
            InstallationHeight = minHeight;
        }

        CalculateFieldofView = 2 * (InstallationHeight - LensFocusLength - 112.6) * Math.tan(Angle / 2 * Math.PI / 180);
        CalculateFieldofView = Math.round(CalculateFieldofView);

        document.getElementById("HMD2048FocusLength").value = LensFocusLength;
        document.getElementById("HMD2048FieldofView").value = CalculateFieldofView;
        document.getElementById("HMD2048InstallationHeight").value = InstallationHeight;


        prepItemM();

    }


    // common Objects to be used:

    const oLocation = {
       RX: ['RX', '', '', 'Rougher Exit (RX)'],
       CSE: ['CSE', '', '', 'Crop Shear Entey (CSE)']
    }
    const ItemHeader = [' ', 'QTY', 'PartNumber', 'Description', 'Status', 'Crate'];
    const emptyRow = ['', '', '', '', '', ''];


  

    var ItemB = [[]];
    var ItemP = [[]];
    const oNetwork = {
        CISCO_SF350_24: ['Code', '1', '*09190', 'ETHERNET SWITCH: 24x10/100 TX RACKMOUNT 100-240VAC', 'PUR', ''],
        CISCO_SG350_10: ['Code', '1', '*09191', 'ETHERNET SWITCH: 10x10/100 TX RACKMOUNT 100-240VAC', 'PUR', ''],
        SFP_100M: ['Code', '1', '*09192', '100BASE-FX SFP MODULE', 'PUR', ''],
        SFP_copper: ['Code', '1', '*09205', '100BASE-T SFP RJ45 MODULE', 'PUR', ''],
        SFP_1000M: ['Code', '1', '*09295', '1000BASE-FX SFP MODULE', 'PUR', ''],  //only used between two cabinets
        Cable_10FT: ['D7', '1', '*08583', 'Network Cable (10ft)', 'STK', 'A2'],
        Cable_2FT: ['D7', '1', '*09150', 'Network Cable (2ft)', 'STK', 'A2']
    };

    const oCabinet = {
        ItemCode: {
            Accuband: ['B', '1', 'C10586-TBA', 'ACCUBAND FLOOR MOUNTED CABINET', 'MFG', 'A5'],
            NotSupplied: ['B', '', '', 'ACCUBAND DISCRETE IO OPTION', '', ''],
            Accucrop: ['P', '1', 'C10728-TBA', 'ACCUCROP FLOOR MOUNTED CABINET', 'MFG', 'A6']
        },
        Options: {
            Yes: ['YES', '', '', 'Accuband FMC2100 is Included '],
            Shared: ['SHARE', '', '', 'Provided in Other Work Order'],
            No: ['NO', '', '', 'To Be Supplied By Others'],
            PS: ['PS', '', '', 'WAGO to Be Installed in Power Supply Box']
        },
        DoorType: {
            S: ['S', '', '', 'Solid Door'],
            G: ['G', '', '', 'Glazed Door']
        },
        Ventilation: {
            S: ['S', '', '', 'Sealed'],
            B: ['B', '', '', 'Blower'],
            AC: ['A', '', '', 'AirConditioned'],
            V: ['', '', '', 'Vented']
        },
        ACVoltage: {
            NA: ['120', '', '', '120VAC'],
            EU: ['240', '', '', '240VAC']
        },
        FMC2100: ['TB0X', '1', 'FMC2100-120-S-G-A', 'FMC2100 CABINET: 120VAC Sealed Glazed Door', 'MFG', ''],
        ScannerControl: ['TB1X', '1', 'PL059172', 'Scanner Control Module Assembly', 'STK', ''],
        DCPowerSupply: ['TB2X', '1', 'PL050988', 'DC Power Supply Module Assembly', 'STK', ''],
        RCA: ['TB3X', '1', 'PL059143', 'RCA INTERFACE MODULE', 'STK', ''],
        ACRInterface: ['TB4X', '1', 'PL059463', 'ACCUCROP INTERFACE MODULE', 'STK', ''],
        DiscreteIO: {
            ACR3: ['TB5X', '1', 'PL059465- 3F', 'ACCUCROP DISCRETE IO', 'MFG', ''],
            AB6: {
                InFMC: ['TB6X', '1', 'WAGO PN', 'ACCUBAND Discrete I/O', 'MFG', ''],
                InOthers: ['TB6X', '1', 'WAGO PN', 'ACCUBAND Discrete I/O', 'MFG', 'A2'],
                InPS: ['Code', '1', 'WAGO PN', 'ACCUBAND Discrete I/O (To Be Installed in Item A6)', 'MFG', 'A2']
            },
        },
        ACR3: ['P0', '1', 'PL058690', 'ACCUCROP CONTROLLER V3', 'MFG', ''],


        AB6WAGOPN: {
            PN: 'PL058790-',
            Copper: '',
            Fiber: 'M', //mediaconvertor is required for Fiber
            ShortRail: '-18',
            WidthGage: 'W',
            ImageGage: 'I'
        },

        WAGOIO: {
            V: ['V', '', '', 'Voltage +/-10V'],
            C: ['C', '', '', 'Current 4-20mA'],
            B: ['B', '', '', 'Current 0-20mA']
        }
    }

    var ItemC = [[]];
    const oCalibrator = {
        ItemCode: ['C', '', '', 'CALIRATOR EQUIPMENT', '', ''],
        CALB: {
            LONG: ['L', '1', 'CALB-L-01', 'LONG WIDTH GAGE CALIBRATOR', 'STK', 'A4'],
            SHORT: ['S', '1', 'CALB-S-01', 'SHORT WIDTH GAGE CALIBRATOR', 'STK', 'A4']
        },

        CARR: {
            LONG: ['L', '1', 'CARR-L-01', 'LONG CALIBRATOR CARRIER', 'STK', 'A4'],
            SHORT: ['S', '1', 'CARR-S-01', 'SHORT CALIBRATOR CARRIER', 'STK', 'A4']
        }
    }

    var ItemD = [[]];
    const oComputer = {
        ItemCode: ['D', '', '', "OPERATOR'S INTERFACE", '', ''],
        Monitor: ['D2', '1', '*08018', '22\" Monitor ', 'PUR', 'A2'],
        PC: ['D1', '1', '*09117', '19\" RackMounted 1U Computer', 'PUR', 'A2'],
        KIP: ['D5', '1', 'PL055640-1', 'KIP Software CD', 'MFG', 'A2'],
        Keyboard: ['D3', '1', '*08836', 'Keyboard ', 'PUR', 'A2'],
        Mouse: ['D4', '1', '*08837', 'Mouse ', 'PUR', 'A2'],
        KeyboardRACK: ['Dx', '1', '*08380', '19" RACK MNT 1U KEYBOARD C/W MOUSE TOUCHPAD', 'PUR', ''],
        MonitorBracket: ['Dx', '1', '*09140', 'MONITOR RACK MOUNT BRACKET; 4U VESA', 'PUR', ''],
        MediaConvertor: ['D6', '1', '*07446', '100M MultiMode Desktop Media Converotr with Power Supply', 'PUR', 'A2'],
        PowerCord: ['D8', '1', '*05023', 'Power Cord IEC to Euro', 'STK', 'A2'],
        NetworkCable: {
            TEN: ['D7', '1', '*08583', 'Network Cable (10ft)', 'STK', 'A2'],
            TWO: ['D7', '1', '*09150', 'Network Cable (2ft)', 'STK', 'A2']
        }
    };  // item D
    var OperatorStation = [
        oComputer.PC,
        oComputer.Monitor,
        oComputer.Keyboard,
        oComputer.Mouse,
        oComputer.KIP
    ];
    var RackMountedPC = [
        oComputer.PC,
        oComputer.Monitor,
        oComputer.KeyboardRACK,
        oComputer.MonitorBracket,
        oComputer.KIP
    ];

    var ItemE = [[]];

    const oBackLight = {
        ItemCode: ['E', '1', 'WBL-L-4600-01', 'LOW PROFILE LED BACKLIGHT SYSTEM: 4000mm LIT LH', 'MFG', ''],
        Orientation: {
            LEFT: ['L', 'LH', '', 'Left Hand'],
            RIGHT: ['R', 'RH', '', 'Right Hand']
        },

        Length: {
            SEVEN: ['7', '7 PAIR', '3400', '2826'],
            EIGHT: ['8', '8 PAIR', '3800', '3232'],
            NINE: ['9', '9 PAIR', '4200', '3638'],
            TEN: ['10', '10 PAIR', '4600', '4045']
        },
        //TEN: ['E1', '1', 'PL058491-10L', 'BACKLIGHT,LED,LOW PROFILE,10 PAIR.LH', 'PRD', 'A7'],
        Backlight: {
            SEVEN: ['7', '1', 'PL058491-7', 'LOW PROFILE LED BACKLIGHT: 7 PAIR', 'PRD', 'A7'],
            EIGHT: ['8', '1', 'PL058491-8', 'LOW PROFILE LED BACKLIGHT: 8 PAIR', 'PRD', 'A7'],
            NINE: ['9', '1', 'PL058491-9', 'LOW PROFILE LED BACKLIGHT: 9 PAIR', 'PRD', 'A7'],
            TEN: ['10', '1', 'PL058491-10', 'LOW PROFILE LED BACKLIGHT: 10 PAIR', 'PRD', 'A7']
        },
        Regulator: ['E2', '1', 'PL053741', 'BACKLIGHT REGULATOR ASSEMBLY', 'PRD', 'A7'],
        PowerSupply: ['E3', '1', 'PL058262', 'LED BACKLIGHT POWER SUPPLY', 'PRD', 'A7'],
        CableHose: ['E4', '1', 'PL058530-20M', 'LED BACKLIGHT CABLE/HOSE ASSY (20m)', 'PRD', 'A7']

    };


    var ItemASDH = [[[]], [[]]]; //item F
    const oASDH = {
        ItemCode: ['F', '', '', 'ACCUSPEED ASDH OPTION', '', ''],
        OrderCode: ['F1', '1', 'ASDH-3500-S-S-15-B', 'ACCUSPEED SYSTEM: RX', 'MFG', ''],
        OH: ['F2', '1', 'PL059040-3500', 'OPTICS HEAD ASSEMBLY:ASDH3500', 'PRF', 'F1'],
        StandOff: {
            ASDH3500: ['3500', '', 'PL059040-3500', '3500 mm'],
            ASDH2100: ['2100', '', 'PL059040-2100', '2100 mm'],
            ASDH1000: ['1000', '', 'PL059040-1000', '1000 mm']
        },
        Nozzle: {//F3
            S: ['S', '1', 'PL054745', 'Standard Optics Head Air Nozzle', 'PRD', 'F1'],
            R: ['R', '1', 'PL0-Reduce', 'Reduced Visibility Optics Head Air Nozzle', 'PRD', 'F1'],
            F: ['F', '1', 'PL0-Flap', 'Reduced Visibility Optics Head Air Nozzle, with Flap', 'PRD', 'F1'],
            Cover: ['', '', '', 'No Nozzle (Window Cover)', 'PRD', 'F1']
        },
        Mount: {//F4
            S: ['S', '1', 'PL055627', 'Standard Optics Head Mount', 'PRD', 'F1'],
            V: ['V', '', 'PL-HeadMount', 'Vibration Isolating Optics Head Mount', 'PRD', 'F1']
        },
        CableHose: ['F5', '1', 'PL059057-15m', 'ASDH OPTICS HEAD CABLE/HOSE ASSEMBLY', 'PRD', 'F2'],
        PowerSupply: ['F6', '1', 'PL058454', 'ASDH POWER SUPPLY ASSEMBLY', 'PRD', 'F2'],
        Accessory: ['F7', '1', 'PL058456', 'ASDH ACCESSORY KIT', 'PRD', 'F1'],
        MediaConvertor: ['F8', '1', 'PL059318', 'KIT: MULTI MODE MEDIA CONVERTER W/ SC (TO BE INSTALLED IN ITEM F6)', 'MFG', 'F2'],
        EU: ['F9', '1', 'ASD-EU-2-1-0-B', 'ASDH ELECTRONICS UNIT ASSY', 'MFG', 'F1'],
        CD: ['F10', '1', 'PL058755-1', 'ASDH DOCUMENTATION PACKAGE', 'PRD', 'F1'],
        CBL: ['F11', '1', 'ASD-CBL-2-1-A-B', 'ASDH Interface Module Assembly ', 'MFG', 'F1'],
        HeatInsulation: ['F12', '1', 'PL055979', 'ASDH Heat Insulation & Reflector', 'STK', 'F1'],
        LevelConvertor: ['F13', '1', '063680', 'Quadrature Push-Pull Driver Board', 'STK', 'F1'],
        Analog: {
            Zero: ['0', '', '', 'No Analog Outputs'],
            Two: ['2', '', '', 'Two Analog Outputs'],
            Four: ['4', '', '', 'Four Analog Outputs'],
            Six: ['6', '', '', 'Six Analog Outputs']
        },
        Quadrature: {
            One: ['1', '', '', 'One Quadrature Output'],
            Two: ['2', '', '', 'Two Quadrature Outputs']
        },
        FieldBus: {
            None: ['0', '', '', 'No Additional Interface'],
            E: ['E', '', '', 'Additional Ethernet Interface']
        }
    };


    var ItemM = [[]];
    const oHMD2048 = {
        ItemCode: ['M', '1', 'HMD2048-SN', 'ACCUSCAN system', 'MFG', ''],
        Camera: ['M1', '1', 'PL059682-2', 'HMD2048 Camera Assembly', 'STK', 'M1'],
        OpticsKit: {
            FORTY: ['40', '1', 'PL056193-IR', 'Optics Kit 40mm IR', 'STK', ''],
            FIFTY: ['50', '1', 'PL059194-IR', 'Optics Kit 50mm IR', 'STK', ''],
            SIXTY: ['60', '1', 'PL059195-IR', 'Optics Kit 60mm IR', 'STK', '']
        },
        Nozzle: ['M3', '1', 'PL054836', 'HMD2048 Nozzle Assembly', 'STK', 'M1'],
        Mount: ['M4', '1', 'PL059687', 'HMD2048 Mounting Bracket', 'STK', 'M1'],
        JunctionBox: ['M5', '1', 'PL059677', 'HMD2048 Junction Box', 'STK', 'M1'],
        Cable: ['M6', '1', 'PL059679-15M', 'HMD2048 Cable Assembly: 15m', 'STK', 'M1'],
        AccessoryKit: ['M7', '1', 'PL054926', 'HMD2048 Accessory Kit', 'STK', 'M1'],
        CD: ['M8', '1', '059885-1', 'HMD2048 USER ACCESS PROGRAM', 'STK', 'M1'],
        HeatInsulation: ['M9', '1', 'PL055980', 'HMD2048 Heat insulation and Reflector', 'STK', 'M1']

    };


    var ItemG = [[]];
    const oItemG = {
        ItemCode: ['G', '', '', 'ADDITIONAL FEATURES:', '', ''],  

        INCencoder: {
            ThroughShaft: ['ThroughShaft', '1', 'PL056704', 'Through Shaft INCREMENTAL ENCODER ASSEMBLY', 'STK', 'A2'],
            ThroughHole: ['ThroughHole', '1', 'PL058604', 'HOLLOW SHAFT INCREMENTAL ENCODER ASSEMBLY', 'STK', 'A2'],
            Other: ['Other', '1', ' ', 'INCREMENTAL ENCODER To Be Supplied By Others', 'REF', '']
            },

        ABSencoder: {
            ThroughShaft: ['ThroughShaft', '1', 'PL056703', 'Through Shaft ABSOLUTE ENCODER ASSEMBLY', 'STK', 'A2'],
            ThroughHole: ['ThroughHole', '1', 'PL058606', 'HOLLOW SHAFT ABSOLUTE ENCODER ASSEMBLY', 'STK', 'A2'],
            Other: ['Other', '1', ' ', 'ABSOLUTE ENCODER To Be Supplied By Others', 'REF', '']
            }
   


    };
    var ItemH = [[]];
    var strItemT = '';

    const oItemH = {
        ItemCode: ['H', '', '', 'ENGINEERING SERVICES:', '', ''],
        itemH1: ['H1', '', '', 'Project Engineering', 'ENG', ''],
        Notes: ['', '', '', 'Project Engineering Notes:', '', '']

    };
    var ItemJ = [[]];
    const oItemJ = {
        ItemCode: ['J', '', '', 'COMMISSIONING AND TRAINING :', '', ''],
        itemJ1:['J1', '', '', 'see  Field Service TBA', 'ENG', '']
    };

    var ItemK = [[]];
    const oDocumentation = {
        ItemCode: ['K', '', '', 'DOCUMENTATION:', '', ''],
        HMD2048: {
            Manual: ['K1', '', '90386', "Accuscan HMD2048 User's Manual", 'ENG', ''],
            UAP: ['K2', '', '054908-1', " UAP HMD2048 Rev. C & User's Manual on CD", 'ENG', ''],
            DWG: ['K3', '', '58960', "Accuscan HMD2048 System Drawing Package", 'ENG', '']
        },
        WidthGage: ['K1', '', '90414', "Accuband Width Gage User's Manuals", 'ENG', ''],
        ImageGage: ['K2', '', '90438', "Accuband Crop Imaging RX System User's Manual", 'ENG', ''],
        ClosedLoop: ['K3', '', '90440', "Accucrop Closed Loop Controller RX Model User's Manual", 'ENG', ''],
        KIP: ['K4', '', '90398', "Accuband Instrumentation Panel User's Manual", 'ENG', ''],
        IBA: ['K5', '', '90444', "ibaPDA and ibaAnalyzer  User's Manual", 'ENG', ''],
        DataBase: ['K6', '', '90453', "Kelk Crop Optimization Database User's Manual", 'ENG', ''],
        ASDH: {
            UserManual: ['K6', '', '90499', "Accuspeed Laser Velocimeter ASDH User Manual", 'ENG', ''],
            InstlManual: ['K7', '', '90500', "Accuspeed Laser Velocimeter ASDH Installation & Commissioning Manual", 'ENG', ''],
            Documentation: ['K8', '', 'PL058755-1', "ASDH DOCUMENTATION PACKAGE", 'REF', '']
        },
        InlineBlower: ['K9', '', '59320', "AIR INLET CHAMBER FOR INLINE DUCT MOUNTED BLOWER", 'ENG', ''],
        DWGPackage: ['K10', '', 'TBA', 'System Drawing Package', '', '']
    };

    var ItemS = [[]];
    const oSoftware = {
        ItemCode: ['S', '', '', 'SOFTWARE', '', ''],
        TS385: ['S1', '1', 'TS-385', ' Crop Imaging Software', 'ENG', ''],
        HCPwidth: {
            TS355: ['TS-355', '1', 'TS-355', 'Accuband TCP/IP Communication Protocol', 'ENG', ''],
            TS365: ['TS-365', '1', 'TS-365', 'Accuband EGD Communication Protocol', 'ENG', ''],
            TBD: ['', '', '', 'Accuband Communication Protocol(TBD)']
        },
        HCPimage: {
            TS354: ['TS-354', '1', 'TS-354', 'TS-354 Accuband TCP/IP Communication Protocol', 'ENG', ''],
            TS405: ['TS-405', '1', 'TS-405', 'TS-405 Accuband EGD Communication Protocol', 'ENG', ''],
            TBD: ['', '', '', 'Accuband  Communication Protocol(TBD)']
        },
        IBA: {
            PC: ['S3', '1', 'PL055226', 'Accuband IBA PDA Kit(Data Logger) c/ w programmed encryption key', 'PUR', 'A2'],
            Gage: ['S3', '1', 'TBA', 'KELK IBA ModBus TCP PDA client software to be installed on scanner', 'ENG', '']
        },
        DataBase: {
            SERVER: ['S3', '1', '*08518', 'Empress Runtime Server V10.20 for Windows 7', 'PUR', 'A2'],
            CLIENT: ['S3', '1', '*08519', 'Empress Runtime Client V10.20 for QNX 6.4', 'PUR', 'A2']
        },
    };

    function getRevision(str) {
        return str.split("-").reverse()[0];
    }

    function getObjectKey(obj, value) {
        //for example: selectID = #selectAirNozzle; obj=AccubandNozzle
        var str = '';
        Object.keys(obj).forEach((key) => {
            if ((obj[key])[0] == value) {
                str = key;
            }
        })
        return str;
    }
    

    function sortTable(itemx,itemCode) {
        var i = 0;

        itemx.forEach((item, index) => {
                item[0] = (i == 0) ? itemCode : itemCode + i;
                i++;
        });

    }

    function printTable(itemx, char, int, sort) { // sort = true to renumber item code fron n.
        var i = int;
        var tableID = 'tableItem' + char;
        var itemCode = char[0];
        //var integer = parseInt(char, 10);
        // alert('Integer=' + integer);
        insertTableRow(tableID, ItemHeader, "HEADER");

        if (itemx.length <= 1) {
            return;
        }
        itemx.forEach((item, index) => {
            //  if (item[0] != '') {
            if (sort) {
                item[0] = (i == 0) ? itemCode : itemCode + i;
                i++;
            }
            insertTableRow(tableID, item, "BODY");
            //  }
        });


        //itemx[0][0] = ((char.length == 1) && (int == 0)) ? (char) : (char[0] + int);
    }

    function validateScannerHead() {
        var bVal = true;
        if (document.getElementById("selectScannerSupport").value == '') {
            document.getElementById("selectScannerSupport").style.color = 'red';
            bVal = false;
        }
        if (document.getElementById("selectAirNozzle").value == '') {
            document.getElementById("selectAirNozzle").style.color = 'red';
            bVal = false;
        }
        if (bVal) {
            prepItemA();
            prepItemC();

        };
        return bVal;
    }
    function prepItemA() {
        var AB6MCKit = (document.getElementById("DistancePSEU").value > 80);
        var modeValue = document.getElementById("selectModeOfOperation").value;
        var modeKey = document.ApplicationForm.ProductType.value == 'WIDTHGAGE' ? getObjectKey(oC965.Mode, modeValue) : 'IR';
        var lensKey = getObjectKey(oC965.OpticsKit, document.getElementById("selectOpticsKit").value);
        var nozzleKey = getObjectKey(oC965.Nozzle, document.getElementById("selectAirNozzle").value);
        var supportKey = getObjectKey(oC965.Support, document.getElementById("selectScannerSupport").value);
        var rev = getRevision(oC965.ItemCode[2]);
        ItemA = [[]];
        ItemA[0] = oC965.ItemCode.slice();
        ItemA[0][2] = 'C965-' + oC965.Mode[modeKey][0] + '-' + oC965.OpticsKit[lensKey][0] + '-' + oC965.Nozzle[nozzleKey][0] + '-' + oC965.Support[supportKey][0] + '-' + rev;
        ItemA.push(oC965.ScannerHead.slice());
    //    ItemA[1][3] = ItemA[1][3] + '(Maximum Width:' + document.getElementById("RollLength").value+'mm; Installation Height:' + document.getElementById("InstallationHeight").value + 'mm)';

        
        ItemA.push(oC965.Cameras.slice());//A2
        ItemA.push(oC965.OpticsKit[lensKey].slice());//A3
        ItemA[3][2] = ItemA[3][2] + '-' + oC965.Mode[modeKey][2];
        ItemA[3][3] = ItemA[3][3] + ' ' + oC965.Mode[modeKey][2];
        ItemA.push(oC965.Support[supportKey].slice());//A4
        ItemA.push(oC965.Shim.slice());//A5
        ItemA.push(oC965.PowerSupply.slice());//A6
        ItemA.push(oC965.CableHose.slice());//A7
        ItemA.push(oC965.Nozzle[nozzleKey].slice());//A8
        if (AB6MCKit) {
            ItemA.push(oC965.MediaConvertor.slice());//A9
        }
        printTable(ItemA, 'A', 0, true);
    }
    /**
     * 
     * 

            document.getElementById("ItemBFMCSupplyOption").style.color = 'black';

            document.getElementById("selectItemB1Option").style.display = getDisplay(($(this).val() == 'YES'));
//            document.getElementById("AccubandWAGOWOID").style.display = getDisplay(($(this).val() == 'SHARE'));

            document.getElementById("ItemBFMCIncluded").style.display = getDisplay(($(this).val() == 'YES'));

            // alert($(this).val());
     * @param code
     */

    function validateItemB(code) {
        var bVal = true;
        var bNew = true;
        var optionValue = document.getElementById("ItemBFMCSupplyOption").value;
        if (optionValue == '')  {
            document.getElementById("ItemBFMCSupplyOption").style.color = 'red';
            return false;
        }
        document.getElementById("ItemBFMCSupplyOption").style.color = 'black';
        document.getElementById("selectItemB1Option").style.display = getDisplay(optionValue == 'YES');
        document.getElementById("AccubandWAGOWOID").style.display = getDisplay(optionValue == 'SHARE');
        document.getElementById("ItemBFMCIncluded").style.display = getDisplay(optionValue == 'YES');
 //       document.getElementById("DiscreteDistance").style.display = getDisplay((optionValue == 'YES') || (optionValue == 'NO'));
 //       alert('2.6');


        document.getElementById("DiscreteDistance").value = (optionValue == 'PS') ? '0' : document.getElementById("DiscreteDistance").value;
        document.getElementById("DiscreteDistance").value = ((optionValue != 'PS') && (document.getElementById("DiscreteDistance").value == '0')) ? '80' : document.getElementById("DiscreteDistance").value;
        if (code == '0') {
            return false;
        }

        switch (document.getElementById("ItemBFMCSupplyOption").value) {
            case 'YES': //FMC is included
                bNew = document.getElementById("ItemBVoltage").value != ''
                document.getElementById("ItemBVoltage").style.color = (bNew ? 'black' : 'red');
                bVal = bVal && bNew;

                bNew = document.getElementById("ItemBDoorType").value != ''
                document.getElementById("ItemBDoorType").style.color = (bNew ? 'black' : 'red');
                bVal = bVal && bNew;

                bNew = document.getElementById("ItemBVentilation").value != ''
                document.getElementById("ItemBVentilation").style.color = (bNew ? 'black' : 'red');
                bVal = bVal && bNew;

                bNew = document.getElementById("DistanceEUL2").value != ''
                document.getElementById("DistanceEUL2").style.color = (bNew ? 'black' : 'red');
                bVal = bVal && bNew;

                break;
            case 'SHARE': // in other w/o
                if (document.getElementById("AccubandWAGOWOID").value == '') {
                    document.getElementById("AccubandWAGOWOID").style.borderColor = 'red';
                    bVal = false;
                }
                break;
            case 'NO': // by others
                // code block
                break;
            case 'PS': // in Power Supply BOX
 

                break;
            default: //probably '0'
                document.getElementById("ItemBFMCSupplyOption").style.color = 'red';
                return;  // exit from function
    }

        //WAGO option here
            if (document.getElementById("AB6WAGOInput").value == '') {
                document.getElementById("AB6WAGOInput").style.color = 'red';
                bVal = false;
            }
            if (document.getElementById("AB6WAGOOutput").value == '') {
                document.getElementById("AB6WAGOOutput").style.color = 'red';
                bVal = false;
            }
            if (document.getElementById("DiscreteDistance").value == '') {
                document.getElementById("DiscreteDistance").style.borderColor = 'red';
            } else {
                document.getElementById("DiscreteDistance").style.borderColor = 'lightgrey';
            }
        
        return bVal;

    }

    function insertNetworkModules() {
        // rules: 1 . if it is WG, check if distance is less than 80m, -> SF350_24; other wise SG350_10.
        // SFP qty for L2
        var qtySFP = parseInt(document.getElementById("DistanceEUL2").value >= 100 ? 1 : 0); 
        //SFP qty for desktops;
        qtySFP = qtySFP + parseInt(document.getElementById("operatorMCQTY").value); // add SFP for desktops.
        //SFP qty for WG
        qtySFP = qtySFP + parseInt(document.getElementById("DiscreteDistance").value > 80 ? 2 : 0); // add SFP for WG.

        //SFP qty for ASD1
        qtySFP = qtySFP + parseInt(document.getElementById("ASDHPSDistance1").value > 80 ? 1 : 0); // add SFP for WG.
        //SFP qty for ASD2 // will be counted for Accucrop EU
 
        //SFP qty for Accucrop EU: 
        var qtySFP_1G = parseInt(((document.getElementById("DistanceAB6").value >= 100) && (document.getElementById("AccucropHeader").style.display=='block')) ? 1 : 0); // add SFP for WG.
        // If it is imaging gage; if distance is less than 80 meters, -> SF350_24; other wise Both;
       // add accuspeed if there is ASDH
        if (ItemASDH[0].length > 1) {

            ItemASDH[0].forEach((item) => {
                if (item[2].indexOf(oASDH.CBL[2].substring(0, 7)) >= 0) {
                    item[5] = ' ' // remove crate 
                    ItemB.push(item.slice());
                    ItemB[ItemB.length - 1][3] = ItemB[ItemB.length - 1][3].split('(')[0];
                    ItemB[ItemB.length - 1][4] = 'REF';
                }
            });
            ItemASDH[0].forEach((item) => {
                if (item[2].indexOf(oASDH.EU[2].substring(0, 6)) >= 0) {
                    item[5] = ' ' // remove crate 
                    ItemB.push(item.slice());
                    ItemB[ItemB.length - 1][3] = ItemB[ItemB.length - 1][3].split('(')[0];
                    ItemB[ItemB.length - 1][4] = 'REF';
                }
            });
        }

        // add a 24 port switch by default
        ItemB.push(oNetwork.CISCO_SF350_24.slice());

        if (qtySFP > 2) {
            ItemB.push(oNetwork.CISCO_SG350_10.slice());
        }
        if (qtySFP > 0) {
            ItemB.push(oNetwork.SFP_100M.slice());
            ItemB[ItemB.length - 1][1] = qtySFP; //change QTY of SFP=2;
        }     

        if (qtySFP_1G> 0) {
            ItemB.push(oNetwork.SFP_1000M.slice());
        }  
    }

    function prepItemB() {
        if (validateItemB() == false) {
            return;
        }
        var FMCOption = document.getElementById("ItemBFMCSupplyOption").value;

        var WidthOrImage = (document.ApplicationForm.ProductType.value == 'WIDTHGAGE' ? oCabinet.AB6WAGOPN.WidthGage : oCabinet.AB6WAGOPN.ImageGage);
        var wagoPN = oCabinet.AB6WAGOPN.PN + document.getElementById("AB6WAGOInput").value + document.getElementById("AB6WAGOOutput").value + WidthOrImage;
        var FiberCopper = (document.getElementById("DiscreteDistance").value > 80 ? oCabinet.AB6WAGOPN.Fiber : oCabinet.AB6WAGOPN.Copper);
        var voltageValue = document.getElementById("ItemBVoltage").value;

        var ventValue = document.getElementById("ItemBVentilation").value;
        var doorValue = document.getElementById("ItemBDoorType").value;
        ItemB = [[]];  // reset ItemB=NULL;
        ItemB[0] = ((FMCOption == 'YES') ? oCabinet.ItemCode.Accuband.slice() : oCabinet.ItemCode.NotSupplied.slice());

        switch (document.getElementById("ItemBFMCSupplyOption").value) {
            case 'YES': //FMC is included

                var voltageDesc = oCabinet.ACVoltage[getObjectKey(oCabinet.ACVoltage, voltageValue)][3];
                var ventDesc = oCabinet.Ventilation[getObjectKey(oCabinet.Ventilation, ventValue)][3];
                var doorDesc = oCabinet.DoorType[getObjectKey(oCabinet.DoorType, doorValue)][3];
                ItemB.push(oCabinet.FMC2100.slice());
                ItemB[1][2] = oCabinet.FMC2100[2].split('-')[0] + '-' + voltageValue + '-' + ventValue + '-' + doorValue + '-' + getRevision(oCabinet.FMC2100[2]);
                ItemB[1][3] = oCabinet.FMC2100[3].split(':')[0] + ': ' + voltageDesc + ' ' + ventDesc + ' ' + doorDesc;
                ItemB.push(oCabinet.ScannerControl.slice());
                ItemB.push(oCabinet.DCPowerSupply.slice());
                ItemB.push(oCabinet.DiscreteIO.AB6.InFMC.slice());
                ItemB[4][2] = wagoPN;

                insertNetworkModules();



                if (document.getElementById("AccubandFMCPC").checked) {                    //check if RackPC is inlcuded

                    RackMountedPC.forEach((item) => {
                        ItemB.push(item.slice());
                    })


                    //                ItemB = ItemB.concat(RackMountedPC.slice());
                }
                ItemB.forEach((item, index) => {
                    item[5] = '';
                })

                ItemB[0][5] = oCabinet.ItemCode.Accuband[5];
                break;
            case 'SHARE': // in other w/o
                ItemB.push(oCabinet.DiscreteIO.AB6.InFMC.slice());
                ItemB[ItemB.length - 1][2] = wagoPN;
                ItemB[ItemB.length - 1][3] = ItemB[ItemB.length - 1][3] + ' (To Be Installed in ' + document.getElementById("AccubandWAGOWOID").value + ')';
                ItemB[ItemB.length - 1][5] = 'TBA';
                break;
            case 'NO': // by others
                wagoPN = wagoPN + FiberCopper;
                ItemB.push(oCabinet.DiscreteIO.AB6.InOthers.slice());
                ItemB[1][2] = wagoPN;
                ItemB.push(oCabinet.DCPowerSupply.slice());
                ItemB[2][5] = ItemB[1][5];
                break;
            case 'PS': // in Power Supply BOX
                wagoPN = wagoPN + oCabinet.AB6WAGOPN.ShortRail;
                ItemB.push(oCabinet.DiscreteIO.AB6.InPS.slice());
                ItemB[1][2] = wagoPN;

                break;
            default:
                alert('Warning ALert');
                return;  // exit from function
        }
        printTable(ItemB, 'B', 0, true);
    }




    function validateItemP() {
        var bVal = true;
        var bNew = true;




        bNew = document.getElementById("ItemPVoltage").value != ''
        document.getElementById("ItemPVoltage").style.color = (bNew ? 'black' : 'red');
        bVal = bVal && bNew;

        bNew = document.getElementById("ItemPDoorType").value != ''
        document.getElementById("ItemPDoorType").style.color = (bNew ? 'black' : 'red');
        bVal = bVal && bNew;


        bNew = document.getElementById("ItemPVentilation").value != ''
        document.getElementById("ItemPVentilation").style.color = (bNew ? 'black' : 'red');
        bVal = bVal && bNew;


        bNew = document.getElementById("DistanceAB6").value != ''
        document.getElementById("DistanceAB6").style.color = (bNew ? 'black' : 'red');
        bVal = bVal && bNew;



        //WAGO option here
        if (document.getElementById("ACR3WAGOInput").value == '') {
            document.getElementById("ACR3WAGOInput").style.color = 'red';
                bVal = false;
        }

        if (document.getElementById("ACR3WAGOOutput").value == '') {
            document.getElementById("ACR3WAGOOutput").style.color = 'red';
                bVal = false;
        }

        return bVal;

    }


    function prepItemP() {
        if (validateItemP() == false) {
            return;
        }

 //       var FMCOption = document.getElementById("ItemBFMCSupplyOption").value;

 //       var WidthOrImage = (document.ApplicationForm.ProductType.value == 'WIDTHGAGE' ? oCabinet.AB6WAGOPN.WidthGage : oCabinet.AB6WAGOPN.ImageGage);
 //       var wagoPN = oCabinet.AB6WAGOPN.PN + document.getElementById("AB6WAGOInput").value + document.getElementById("AB6WAGOOutput").value + WidthOrImage;
        var bFiber = (document.getElementById("DistanceAB6").value > 100);

        var voltageValue = document.getElementById("ItemPVoltage").value;
        var ventValue = document.getElementById("ItemPVentilation").value;
        var doorValue = document.getElementById("ItemPDoorType").value;
        var voltageDesc = oCabinet.ACVoltage[getObjectKey(oCabinet.ACVoltage, voltageValue)][3];
        var ventDesc = oCabinet.Ventilation[getObjectKey(oCabinet.Ventilation, ventValue)][3];
        var doorDesc = oCabinet.DoorType[getObjectKey(oCabinet.DoorType, doorValue)][3];
        var qtySFP_1G = parseInt(document.getElementById("DistanceAB6").value >= 100 ? 1 : 0); // add SFP_1G for two cabinets
        var qtySFP = parseInt(document.getElementById("ASDHPSDistance2").value >= 80 ? 1 : 0); // add SFP for ASDH2.


        ItemP = [[]];  // reset ItemP=NULL;
        ItemP[0] = oCabinet.ItemCode.Accucrop.slice();
        ItemP.push(oCabinet.ACR3.slice());

        ItemP.push(oCabinet.FMC2100.slice());
        ItemP[ItemP.length-1][2] = oCabinet.FMC2100[2].split('-')[0] + '-' + voltageValue + '-' + ventValue + '-' + doorValue + '-' + getRevision(oCabinet.FMC2100[2]);
        ItemP[ItemP.length - 1][3] = oCabinet.FMC2100[3].split(':')[0] + ': ' + voltageDesc + ' ' + ventDesc + ' ' + doorDesc;

        ItemP.push(oCabinet.ScannerControl.slice());

        ItemP.push(oCabinet.DCPowerSupply.slice());
        ItemP.push(oCabinet.RCA.slice());
        ItemP.push(oCabinet.ACRInterface.slice());//TB4
        ItemP.push(oCabinet.DiscreteIO.ACR3.slice()); //TB5
        //insert accuband discrete io if one cabinet
        if ((document.getElementById("ItemBFMCSupplyOption").value != 'YES') && (ItemB.length == 2)) {
            ItemB[1][5] = '';
            ItemP.push(ItemB[1].slice());
            ItemP[ItemP.length - 1][4] = 'REF';
        }//

        // insert ItemASDH[0] module here;
        if ((document.getElementById("ItemBFMCSupplyOption").value != 'YES') && (ItemASDH[0].length > 1)) {
            ItemASDH[0].forEach((item) => {
                if (item[2].indexOf(oASDH.CBL[2].substring(0, 7)) >= 0) {
                    item[5] = ' ' // remove crate 
                    ItemP.push(item.slice());
                    ItemP[ItemP.length - 1][3] = ItemP[ItemP.length - 1][3].split('(')[0];
                    ItemP[ItemP.length - 1][4] = 'REF';
            }
        });

        ItemASDH[0].forEach((item) => {
            if (item[2].indexOf(oASDH.EU[2].substring(0, 6)) >= 0) {
                item[5] = ' ' // remove crate 
                ItemP.push(item.slice());
                ItemP[ItemP.length - 1][3] = ItemP[ItemP.length - 1][3].split('(')[0];
                ItemP[ItemP.length - 1][4] = 'REF';
            }
        });
    }

        // insert ItemASDH[1] module here;
        if (ItemASDH[1].length > 1) {
            ItemASDH[1].forEach((item) => {
                if (item[2].indexOf(oASDH.CBL[2].substring(0, 7)) >= 0) {
                    item[5] = ' ' // remove crate 
                    ItemP.push(item.slice());
                    item[3] = item[3] + ' (To Be Installaed in Item P)';
                    ItemP[ItemP.length - 1][4] = 'REF';
                }
            });
            ItemASDH[1].forEach((item) => {
                if (item[2].indexOf(oASDH.EU[2].substring(0, 6)) >= 0) {
                    item[5] = ' ' // remove crate 
                    ItemP.push(item.slice());
                    item[3] = item[3] + ' (To Be Installaed in Item P)';
                    ItemP[ItemP.length - 1][4] = 'REF';
                }
            });
        }

        //insert network module
        if ((document.getElementById("ItemBFMCSupplyOption").value != 'YES') && (document.getElementById("ItemBFMCSupplyOption").value != '')) {
            qtySFP = qtySFP + parseInt(document.getElementById("DiscreteDistance").value > 80 ? 2 : 0); // add WG.
            qtySFP = qtySFP + parseInt(document.getElementById("ASDHPSDistance1").value > 80 ? 1 : 0); // add ASDH1.
            qtySFP = qtySFP + parseInt(document.getElementById("operatorMCQTY").value); // add SFP for desktops.
        }
        qtySFP = qtySFP + parseInt(document.getElementById("ASDHPSDistance2").value > 80 ? 1 : 0); // add ASDH2.

        ItemP.push(oNetwork.CISCO_SF350_24.slice());
        if (qtySFP > 2) {
            ItemP.push(oNetwork.CISCO_SG350_10.slice());
        }
        if (qtySFP > 0) {
            ItemP.push(oNetwork.SFP_100M.slice());
            ItemP[ItemP.length - 1][1] = qtySFP; //change QTY of SFP=2;
        }     

        if (qtySFP_1G > 0) {
            ItemP.push(oNetwork.SFP_1000M.slice());
        } 
        if (document.getElementById("AccucropFMCPC").checked) {                    //check if RackPC is inlcuded
            RackMountedPC.forEach((item) => {
                ItemP.push(item.slice());
            })
        }

        ItemP.forEach((item, index) => {
            item[5] = '';
        })

        ItemP[0][5] = oCabinet.ItemCode.Accucrop[5];

        printTable(ItemP, 'P', 0, true);
        prepItemB();

    }




    function prepItemC() {
        var length = document.getElementById("RollLength").value;  // length of Long Calibrator is 1666mm. add 5% extra.
        var pitch = document.getElementById("RollPitch").value; //
        var calSize = ((length > 1666 * 1.05) ? 'LONG' : 'SHORT'); //calibrator;
        var carrSize = (((pitch < 300) || ((pitch > 600) && (pitch < 900))) ? 'SHORT' : 'LONG');
        var isChecked = document.getElementById("CalibratorChecked").checked;
        ItemC = [[]];
        if (isChecked) {
            ItemC[0] = oCalibrator.ItemCode.slice();
            ItemC.push(oCalibrator.CALB[calSize].slice());
            ItemC.push(oCalibrator.CARR[carrSize].slice());
        }
        printTable(ItemC, 'C', 0, true);
    }

    function prepItemG() {
        var itemKey = '';
        ItemG = [[]];

        ItemG[0] = oItemG.ItemCode.slice();
        Object.keys(oItemGCheckList).forEach((key) => {
            if (document.getElementById(oItemGCheckList[key]['ID'][1]).checked) {
                ItemG.push(oItemGCheckList[key]['Value'].slice());
            }
        })

        if (document.ApplicationForm.ProductType.value == 'CLOSEDLOOP') {
            itemKey = getObjectKey(oItemG.ABSencoder, document.getElementById("selectABSEncoder").value);
            if(itemKey!='')
                ItemG.push(oItemG.ABSencoder[itemKey].slice());
            itemKey = getObjectKey(oItemG.INCencoder, document.getElementById("selectINCEncoder").value);
            if (itemKey != '')
                ItemG.push(oItemG.INCencoder[itemKey].slice());
        }
 

        printTable(ItemG, 'G', 0, true);

    }

    function prepItemD() {
        var qty = document.getElementById("selKIPQTY").value;
        var isPCSelected = (document.getElementById("selectedPC").value == 'YES');
        var mcQTY = document.getElementById("operatorMCQTY").value;
        var isPowerCodeRequired = (document.getElementById("ItemDVoltage").value == '240') && ((mcQTY > 0) || (isPCSelected && (qty>0)));
        var i;
        ItemD = [[]];

        //       ItemD[0] = JSON.parse(JSON.stringify(oComputer.ItemCode));  //copy

        ItemD[0] = oComputer.ItemCode.slice();
        if (isPCSelected && (qty > 0)) {// sort
            for (i = 0; i < qty; i++) {
                if (i > 0) {
                    ItemD.push(oComputer.ItemCode.slice());
                    ItemD[ItemD.length - 1][0] = 'D' + i + '0';
                    ItemD[ItemD.length - 1][3] = ItemD[ItemD.length - 1][3] + '  -' + (i + 1);
                }
                OperatorStation.forEach((item) => {
                    ItemD.push(item.slice());

                    ItemD[ItemD.length - 1][0] = (i == 0) ? ItemD[ItemD.length - 1][0] : ItemD[ItemD.length - 1][0].substr(0, 1) + i + ItemD[ItemD.length - 1][0].substr(1, 1);
                })
                if (mcQTY > 0) {
                    ItemD.push(oComputer.MediaConvertor.slice());
                    ItemD[ItemD.length - 1][0] = (i == 0) ? ItemD[ItemD.length - 1][0] : ItemD[ItemD.length - 1][0].substr(0, 1) + i + ItemD[ItemD.length - 1][0].substr(1, 1);
                    ItemD.push(oComputer.NetworkCable['TEN'].slice());
                    ItemD[ItemD.length - 1][0] = (i == 0) ? ItemD[ItemD.length - 1][0] : ItemD[ItemD.length - 1][0].substr(0, 1) + i + ItemD[ItemD.length - 1][0].substr(1, 1);
                }
                if (isPowerCodeRequired) {
                    ItemD.push(oComputer.PowerCord.slice());
                    if (mcQTY <= 0) {
                        ItemD[ItemD.length - 1][1] = 2;

                        ItemD[ItemD.length - 1][0] = (i == 0) ? 'D6' : 'D' + i + '6';
                    } else {
                        ItemD[ItemD.length - 1][1] = 3;

                        ItemD[ItemD.length - 1][0] = (i == 0) ? 'D8' : 'D' + i + '8';
                    }
                }
                mcQTY--;
                ItemD.push(emptyRow.slice());
            }


            printTable(ItemD, 'D', 0, false);

        } else {
            if (qty > 0) {
                ItemD.push(oComputer.KIP.slice());
                ItemD[ItemD.length - 1][1] = qty;

            }

            if ((mcQTY > 0)) {
                ItemD.push(oComputer.MediaConvertor.slice());
                ItemD[ItemD.length - 1][1] = mcQTY;
                ItemD.push(oComputer.NetworkCable['TEN'].slice());
                ItemD[ItemD.length - 1][1] = mcQTY;
            }

            if (isPowerCodeRequired && ((qty > 0) || (mcQTY > 0))) {
                ItemD.push(oComputer.PowerCord.slice());
                ItemD[ItemD.length - 1][1] = parseInt(mcQTY) + parseInt(qty) * (isPCSelected ? 2 : 0);
            }
            printTable(ItemD, 'D', 0, true);

        }
        prepItemB();

    }

    function prepItemE() {
        var size = document.getElementById("BackLightSize").value
        var ort = document.getElementById("backLightOrientation").value;
        var strKey = getObjectKey(oBackLight.Length, size.substr(0, 1));
        //calibrator P/N
        var isBacklight = (document.getElementById("selectModeOfOperation").value == 'B');
        ItemE = [[]];
        if (isBacklight) {
            ItemE[0] = oBackLight.ItemCode.slice();
            ItemE[0][2] = oBackLight.ItemCode[2].split('-')[0] + '-' + ort + '-' + oBackLight.Length[strKey][2] + '-' + getRevision(oBackLight.ItemCode[2]);
            ItemE[0][3] = oBackLight.ItemCode[3].split(':')[0] + ':' + oBackLight.Length[strKey][3] + 'mm LIT' + '  ' + ort + 'H';
            ItemE.push(oBackLight.Backlight[strKey].slice());
            ItemE[1][2] = ItemE[1][2] + ort;
            ItemE[1][3] = ItemE[1][3] + '  ' + ort;
            ItemE.push(oBackLight.Regulator.slice());
            ItemE.push(oBackLight.PowerSupply.slice());
            ItemE.push(oBackLight.CableHose.slice());
        }
        printTable(ItemE, 'E', 0, true);
    }

    function validateASDH(n) {
        var bVal = true;
        if (document.getElementById("ASDHOH" + n).value == '') {
            document.getElementById("ASDHOH" + n).style.color = 'red';
            bVal = false;
        }
        if (document.getElementById("ASDHNozzle" + n).value == '') {
            document.getElementById("ASDHNozzle" + n).style.color = 'red';
            bVal = false;
        }
        if (document.getElementById("ASDHMount" + n).value == '') {
            document.getElementById("ASDHMount" + n).style.color = 'red';
            bVal = false;
        }
        if (document.getElementById("ASDEUAO" + n).value == '') {
            document.getElementById("ASDEUAO" + n).style.color = 'red';
            bVal = false;
        }
        if (document.getElementById("ASDEUQO" + n).value == '') {
            document.getElementById("ASDEUQO" + n).style.color = 'red';
            bVal = false;
        }
        if (document.getElementById("ASDEUFieldBus" + n).value == '') {
            document.getElementById("ASDEUFieldBus" + n).style.color = 'red';
            bVal = false;
        }
        if (bVal) {
            prepASDH(n);
        };
    }

    function prepASDH(n) {

        var location = document.getElementById("ASDHLocation" + n).value;
        var cableLength = document.getElementById("ASDHCableLength" + n).value;

        var distance = document.getElementById("ASDHPSDistance" + n).value;

        var OHValue = document.getElementById("ASDHOH" + n).value;

        var nozzleValue = document.getElementById("ASDHNozzle" + n).value;

        var mountValue = document.getElementById("ASDHMount" + n).value;

        var OHKey = getObjectKey(oASDH.StandOff, OHValue);
        var nozzleKey = getObjectKey(oASDH.Nozzle, nozzleValue);
        var moutKey = getObjectKey(oASDH.Mount, mountValue);
        var AOValue = document.getElementById("ASDEUAO" + n).value;
        var QOValue = document.getElementById("ASDEUQO" + n).value;
        var FBValue = document.getElementById("ASDEUFieldBus" + n).value;
        var cblType = (document.ApplicationForm.ProductType.value=='ASDH')?"C":'A'
        var installation = '';

        if ((document.getElementById('ItemBFMCSupplyOption').value == 'YES') && (n == 1)) {
            installation = ' (To Be installed in Item B)';
        } else if (document.getElementById('AccucropHeader').style.display == 'block') {
            installation = ' (To Be installed in Item P)';
        }


        ItemASDH[n - 1] = [[]];
        ItemASDH[n - 1][0] = oASDH.ItemCode.slice();

        ItemASDH[n - 1].push(oASDH.OrderCode.slice()); //[1]
        ItemASDH[n - 1][1][2] = oASDH.OrderCode[2].split('-')[0] + '-' + OHValue + '-' + nozzleValue + '-' + mountValue + '-' + cableLength+'-'+ getRevision(oASDH.OrderCode[2]);
        ItemASDH[n - 1][1][3] = oASDH.OrderCode[3].split(':')[0] + '  ' + location;

        ItemASDH[n - 1].push(oASDH.OH.slice()); //[2]
        ItemASDH[n - 1][2][2] = oASDH.StandOff[OHKey][2];
        ItemASDH[n - 1][2][3] = oASDH.OH[3].split(':')[0] + ':  ASDH' + oASDH.StandOff[OHKey][0];

        ItemASDH[n - 1].push(oASDH.Nozzle[nozzleKey].slice()); //[3]

        ItemASDH[n - 1].push(oASDH.Mount[moutKey].slice()); //[4]

        ItemASDH[n - 1].push(oASDH.CableHose.slice()); //[5]
        ItemASDH[n - 1][5][2] = oASDH.CableHose[2].split('-')[0] + '-' + cableLength + 'm';
        ItemASDH[n - 1][5][3] = oASDH.CableHose[3] + '  ' + cableLength + 'm';

        ItemASDH[n - 1].push(oASDH.PowerSupply.slice()); //[6]

        ItemASDH[n - 1].push(oASDH.Accessory.slice()); //[7]
        if (distance > 80) {
            ItemASDH[n - 1].push(oASDH.MediaConvertor.slice()); //[8]
            if (n == 2) {
                ItemASDH[1][8][3] = ItemASDH[1][8][3].split('F6')[0] + ' ' + "F26)";
            }
            ItemASDH[n - 1][ItemASDH[n - 1].length - 1][2]

        }

        ItemASDH[n - 1].push(oASDH.EU.slice()); //[8]

        ItemASDH[n - 1][ItemASDH[n - 1].length - 1][2] = oASDH.EU[2].split('-')[0] + '-' + oASDH.EU[2].split('-')[1] + '-' + AOValue + '-' + QOValue + '-' + FBValue + '-' + getRevision(oASDH.EU[2]);
        ItemASDH[n - 1][ItemASDH[n - 1].length - 1][3] += installation;
        ItemASDH[n - 1].push(oASDH.CD.slice()); //[9]
        ItemASDH[n - 1].push(oASDH.CBL.slice()); //[10]
        ItemASDH[n - 1][ItemASDH[n - 1].length - 1][2] = oASDH.CBL[2].split('-')[0] + '-' + oASDH.CBL[2].split('-')[1] + '-' + AOValue + '-' + QOValue + '-' + cblType + '-' + getRevision(oASDH.CBL[2]);
        ItemASDH[n - 1][ItemASDH[n - 1].length - 1][3] += installation;

        ItemASDH[n - 1].push(oASDH.HeatInsulation.slice()); //[11]

        if (document.getElementById("ASDHLever" + n).checked) {
            ItemASDH[n - 1].push(oASDH.LevelConvertor.slice()); //[13]
        }
        printTable(ItemASDH[n - 1], 'F' + n, 20 * (n - 1), true);
        prepItemB();
    }

    function prepItemM() {
        var lensKey = getObjectKey(oHMD2048.OpticsKit, document.getElementById("HMD2048FocusLength").value);
        var instlHeight = document.getElementById("HMD2048InstallationHeight").value;

        ItemM = [[]];

        ItemM[0] = oHMD2048.ItemCode.slice();

        ItemM.push(oHMD2048.Camera.slice());

        ItemM.push(oHMD2048.OpticsKit[lensKey].slice());//M2

        ItemM.push(oHMD2048.Nozzle.slice());//M3
        ItemM.push(oHMD2048.Mount.slice());//M4
        ItemM.push(oHMD2048.JunctionBox.slice());//M5
        ItemM.push(oHMD2048.Cable.slice());//M6
        ItemM.push(oHMD2048.AccessoryKit.slice());//M7
        ItemM.push(oHMD2048.CD.slice());//M8
        ItemM.push(oHMD2048.HeatInsulation.slice());//M39


        printTable(ItemM, 'M', 0, true);
    }



    function prepItemH() {

        ItemH = [[]];
        strItemT = '\n';

        ItemH[0] = oItemH.ItemCode.slice();
        ItemH.push(oItemH.itemH1.slice());
        if (document.getElementById("RollDataHeader").style.display == 'block') {
            strItemT += 'Roll Length = ' + document.getElementById("RollLength").value + 'mm\n';
            strItemT += 'Overscan = ' + document.getElementById("AB6Overscan").value + '%\n  ';
            strItemT += 'HOP = ' + document.getElementById("AB6HOP").value + 'mm\n ';
            strItemT += 'Roll Pitch = ' + document.getElementById("RollPitch").value + 'mm \n ';
            strItemT += 'Roll Diameter= ' + document.getElementById("RollDiameter").value + 'mm \n ';
            if (document.getElementById("BackLightHeader").style.display=='block')
                strItemT += 'BackLight Distance Below Pass Line= ' + document.getElementById("backLightDistance").value + 'mm \n ';
            strItemT += 'existing Platform Height= ' + document.getElementById("existingPlatformHeight").value + 'mm \n ';
            strItemT += 'Installation Height= ' + document.getElementById("InstallationHeight").value + 'mm \n  ';
            strItemT += 'Platform Height= ' + document.getElementById("calculatedPlatformHeight").value + 'mm \n';
            strItemT += 'Field Of view= ' + document.getElementById("FieldofView").value + 'mm \n  ';
            if (document.getElementById("BackLightHeader").style.display == 'block') {
                strItemT += 'FOV @ BackLight= ' + document.getElementById("FOVBackLight").value + 'mm \n  ';
                strItemT += 'BackLightSize= ' + document.getElementById("BackLightSize").value + ':' + document.getElementById("LitLength").value + 'mm" \n ';
            }
        }
        if (document.getElementById("AccubandFMCHeader").style.display == 'block') {
            strItemT += 'Distance from Discrete IO to PS= ' + document.getElementById("DiscreteDistance").value + 'm \n  ';
            strItemT += 'Distance from Discrete IO to L2= ' + document.getElementById("DistanceEUL2").value + 'm \n  ';
        }
        if (document.getElementById("HMD2048Header").style.display == 'block') {
            strItemT += 'HMD Roll Length= ' + document.getElementById("HMD2048RollLength").value + 'mm \n  ';
            strItemT += 'HMD2048InstallationHeight=' + document.getElementById("HMD2048InstallationHeight").value + 'mm \n  ';
        }

        if (document.getElementById("AccucropHeader").style.display == 'block') {
            strItemT += 'Distance from Accucrop FMC to AB6 FMC ' + document.getElementById("DistanceAB6").value + 'mm \n  ';
        }

    }
    function prepItemJ() {

        var strNotes = document.getElementById("FieldServiceNotes").value;
        ItemJ = [[]];
        ItemJ[0] = oItemJ.ItemCode.slice();
        ItemJ.push(oItemJ.itemJ1.slice());
        if (strNotes!='') {
            ItemJ[1][3] = strNotes;
        }

    }

    function prepItemK() {

        var isIBAselected = document.getElementById("IBAKit").checked;
        var isDatabase = document.getElementById("TS414Server").checked;
        var isInlineBlower = false;
        var isClosedLoop = (document.ApplicationForm.ProductType.value == 'CLOSEDLOOP');

        var isOpenLoop = (document.ApplicationForm.ProductType.value == 'OPENLOOP') || isClosedLoop;
        var isImageGage = (document.ApplicationForm.ProductType.value == 'IMAGEGAGE') || isOpenLoop || isClosedLoop;
        var isWidthGage = (document.ApplicationForm.ProductType.value == 'WIDTHGAGE') || isImageGage || isOpenLoop || isClosedLoop;
        var isASDH = isImageGage ;
        var isHMD2048 = isOpenLoop;

        var isKip = isWidthGage;

        ItemK = [[]];
        ItemK[0] = oDocumentation.ItemCode.slice();

        if (isWidthGage) {
            ItemK.push(oDocumentation.WidthGage.slice());
        };
        
        if (isImageGage) {
            ItemK.push(oDocumentation.ImageGage.slice());
        };
        if (isClosedLoop) {
            ItemK.push(oDocumentation.ClosedLoop.slice());
        };

        if (isHMD2048) {
            ItemK.push(oDocumentation.HMD2048.Manual.slice());
            ItemK.push(oDocumentation.HMD2048.UAP.slice());
            ItemK.push(oDocumentation.HMD2048.DWG.slice());
        };
        if (isASDH) {
            ItemK.push(oDocumentation.ASDH.UserManual.slice());
            ItemK.push(oDocumentation.ASDH.InstlManual.slice());
            ItemK.push(oDocumentation.ASDH.Documentation.slice());
        };

        if (isInlineBlower) {
            ItemK.push(oDocumentation.InlineBlower.slice());
        };


        if (isKip) {
            ItemK.push(oDocumentation.KIP.slice());
        };
        if (isIBAselected) {
            ItemK.push(oDocumentation.IBA.slice());
        }

        if (isDatabase) {
            ItemK.push(oDocumentation.DataBase.slice());

        }
        ItemK.push(oDocumentation.DWGPackage.slice());

        sortTable(ItemK,'K');

    }

    function prepItemS() {
        var hcpKey;


        ItemS = [[]];
        ItemS[0] = oSoftware.ItemCode.slice();

        if (document.ApplicationForm.ProductType.value == 'WIDTHGAGE') {
            hcpKey = getObjectKey(oSoftware.HCPwidth, document.getElementById("selectWidthGageHCP").value);
            ItemS.push(oSoftware.HCPwidth[hcpKey].slice());
        } else {
            ItemS.push(oSoftware.TS385.slice());
            hcpKey = getObjectKey(oSoftware.HCPimage, document.getElementById("selectImageGageHCP").value);
            ItemS.push(oSoftware.HCPimage[hcpKey].slice());
        }

        Object.keys(oItemSCheckList).forEach((key) => {
            if (document.getElementById(oItemSCheckList[key]['ID'][1]).checked) {
                ItemS.push(oItemSCheckList[key]['Value'].slice());
            }
        })

        printTable(ItemS, 'S', 0, true);
    }

    function showWorkOrderInfo() {
        document.getElementById("WorkOrderInfo").style.display = 'block';
    }
    function continueWorkOrder() {

        download_csv();
    }
    var crateArray = [0];
    function checkIndex(crateArray) {
        return crateArray == this;
    }
    function conversion(arr, line, folderDate, mfgDate, shippingDate) {
        var str = '';
        var ret = [str, line];
        var firstCrateNumber = document.getElementById("firstCrateNumber").value;

        var iCrate;
        //      if (arr.length < 6) return ret;

        arr.forEach(function (item, index) {
            if (item.length >= 6) {

                if (item[5].length == 2) {
                    iCrate = crateArray.findIndex(checkIndex, item[5]);

                    if (iCrate == -1) {
                        iCrate = crateArray.length;
                        crateArray.push(item[5]);
                    } 
                    item[5] = parseInt(iCrate) + parseInt(firstCrateNumber)-1;
                }

            }

        });


        arr.forEach(function (item, index) {
            if (item.length >= 6) {
                str += line + ',';
                str += item[0] + ',';
                str += item[1] + ',';
                str += ((item[1] == '') ? '' : 'EA') + ',';
                str += item[2] + ',';
                str += item[3] + ',';
                str += '' + ','; //sn
                str += item[4] + ',';
                str += ((item[4] == 'MFG') ? folderDate : '') + ',';
                str += ((item[1] == '') ? '' : mfgDate) + ',';
                str += ((item[1] == '') ? '' : shippingDate) + ',';
                str += '' + ','; //tran
                // some code here to deal with crate numbers
                str += item[5] + ',';
                str += "\n";
                line++;
            }
        });
        str += line + ',';
        line++;
        str += "\n";
        ret = [str, line];
        return ret;
    }


    function download_csv() {
        var folderDate = document.getElementById("folderDate").value;
        var shippingDate = document.getElementById("shippingDate").value;
        var mfgDate = document.getElementById("mfgDate").value;
        var quotation = document.getElementById("Quotation").value;
        var fileName = (quotation == '') ? 'C965.csv' : (quotation + '.csv');
        var workOrder = document.getElementById("WorkOrder").value;
        var firstCrateNumber = document.getElementById("firstCrateNumber").value;

        workOrder = (workOrder == '') ? 'C965' : workOrder;
        var csv = workOrder + ',Item,QTY,UOM,PartNumber,Description,SN,Status,FolderDate,MFGDate,ShipDate,Tran,Crate\n';


        var line = 1;
        var sType = document.ApplicationForm.ProductType.value;
        var isBackLight = (document.getElementById("selectModeOfOperation").value == "B");
        var is2ndASDH = (document.getElementById("secondASDH").value == "REMOVE")

        if ((sType == 'WIDTHGAGE') || (sType == 'IMAGEGAGE') || (sTYpe = 'OPENLOOP') || (sType == 'CLOSEDLOOP')) {

            ret = conversion(ItemA, line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];


            ret = conversion(ItemB, line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];

            ret = conversion(ItemC, line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];

            ret = conversion(ItemD, line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];
        }
        if ((sType == 'WIDTHGAGE') && (isBackLight)) {
            ret = conversion(ItemE, line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];
        }
        if ((sType == 'IMAGEGAGE') || (sTYpe = 'OPENLOOP') || (sType == 'CLOSEDLOOP')) {
            ret = conversion(ItemASDH[0], line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];
            if (is2ndASDH) {
                ret = conversion(ItemASDH[1], line, folderDate, mfgDate, shippingDate);
                csv += ret[0];
                line = ret[1];
            }
        }
        if (ItemM.length > 1) {
            ret = conversion(ItemM, line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];
        }
            
        if (sType == 'CLOSEDLOOP') {
            ret = conversion(ItemP, line, folderDate, mfgDate, shippingDate);
            csv += ret[0];
            line = ret[1];
        }


        ret = conversion(ItemG, line, folderDate, mfgDate, shippingDate);
        csv += ret[0];
        line = ret[1];
        
        prepItemH();
        ret = conversion(ItemH, line, folderDate, mfgDate, shippingDate);
        csv += ret[0];
        line = ret[1];

        prepItemJ();
        ret = conversion(ItemJ, line, folderDate, mfgDate, shippingDate);
        csv += ret[0];
        line = ret[1];

        prepItemK();
        ret = conversion(ItemK, line, folderDate, mfgDate, shippingDate);
        csv += ret[0];
        line = ret[1];

        ret = conversion(ItemS, line, folderDate, mfgDate, shippingDate);
        csv += ret[0];
        line = ret[1];


        document.getElementById("lastCrateNumber").value = parseInt(crateArray.length) + parseInt(firstCrateNumber) - 2;

        csv += strItemT;
        
        console.log(csv);
        var hiddenElement = document.createElement('a');
        hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
        hiddenElement.target = '_blank';
        hiddenElement.download = fileName;
        hiddenElement.click();
    }

    function execute() {
        document.getElementById("PreferredHeight").value = "have a nice day"
    }


</script>


